webpackJsonp([45],{242:function(e,t,a){try{(function(){"use strict";function r(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){var a=[],r=!0,n=!1,l=void 0;try{for(var s,o=e[Symbol.iterator]();!(r=(s=o.next()).done)&&(a.push(s.value),!t||a.length!==t);r=!0);}catch(e){n=!0,l=e}finally{try{!r&&o.return&&o.return()}finally{if(n)throw l}}return a}return function(t,a){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=a(2),s=r(l),o=a(1),i=a(8),u=a(9),d=(r(u),a(4)),c=r(d),f=a(14),m=r(f),p=a(13),h=r(p),g=a(5),y=r(g),v=a(11),b=(r(v),a(18)),E=r(b),w=a(6),S=(r(w),a(7)),k=(r(S),/^[a-zA-Z0-9\-_\/]{6,16}$/),P=s.default.createClass({displayName:"ImportForm",propTypes:{setTaskStore:l.PropTypes.func},getInitialState:function(){return{phoneInfo:null,unsupport:!1,showUnsupport:!1,isStart:!1,defaultUsername:"",defaultPassword:"",defaultCode:""}},componentDidMount:function(){var e=document.getElementsByClassName("d-zczx")[0],t=document.body.clientHeight;window.onresize=function(){document.body.clientHeight<t?e.style.display="none":e.style.display="inherit"}},componentWillUnmount:function(){this.unmount=!0},render:function(){var e=this.handleImport,t=this.handleProtocol,a=this.handleJumpPage,r=this.state,n=r.unsupport,l=r.showUnsupport,i=r.isStart,u=(r.defaultUsername,r.defaultCode),d=void 0!=o.qsParams.agreementEntryText?o.qsParams.agreementEntryText:"同意《用户使用协议》",c=m.default.get("zhengxin",0,0,0),f="";c&&c.loginParam&&(f=c.loginParam.account);var p=l?s.default.createElement("div",{className:"carrier-unsupport"},s.default.createElement("i",null),s.default.createElement("p",null,n)):s.default.createElement("div",null,s.default.createElement("div",{className:"input-item"},s.default.createElement(h.default,{type:"text",ref:"username",id:"zxUsername",placeholder:"请\b输入用户名",label:"用户名",defaultValue:f})),s.default.createElement("div",{className:"input-item"},s.default.createElement(h.default,{type:"password",ref:"password",id:"zxPassword",placeholder:"请输入密码",label:"密码"})),s.default.createElement("div",{className:"input-item"},s.default.createElement(h.default,{type:"text",ref:"code",id:"zxCode",defaultValue:u,placeholder:"请输入身份验证码",label:"身份验证码"})),s.default.createElement("div",{style:{display:"NO"==o.qsParams.showAgreement||0==o.qsParams.showAgreement?"none":"block"},className:"protocol"},s.default.createElement("input",{id:"protocol",ref:"protocol",type:"checkbox",defaultChecked:!0}),s.default.createElement("label",{htmlFor:"protocol"},s.default.createElement("span",{style:{background:o.qsParams.themeColor?"#"+o.qsParams.themeColor:"rgb(126, 195, 235)"}})),s.default.createElement("a",{onClick:t},d)),s.default.createElement("div",{className:"page-wrapper"},s.default.createElement(y.default,{types:"full",onTap:e,disable:i,state:i,getState:function(e){switch(e){case!1:return"提交";case!0:return"登录中...";default:return"提交"}}})),s.default.createElement("div",{className:"d-ttip"},s.default.createElement("div",null,"温馨提示:"),s.default.createElement("div",{className:"input-tiptext"},"提交查询申请后的24小时内，人行征信中心会发送身份验证码到您的手机，身份验证码7天内有效！")),s.default.createElement("div",{className:"official-site-link-div"},s.default.createElement("a",{onClick:a,className:"official-site-link d-zczx"},"点此注册人行征信账号")));return s.default.createElement("div",null,s.default.createElement(E.default,null,p))},handleImport:function(){var e=this,t=this.props,a=t.onSubmitTaskDone,r=(t.getScript,this.state.phoneInfo,this.refs.username.getValue()),n=this.refs.password.getValue(),l=this.refs.code.getValue();if(!r||!k.test(r))return void setTimeout(function(){return c.default.alert("请输入正确的登录名","")});if(!n||n.length<6||n.length>20)return void setTimeout(function(){return c.default.alert("请输入正确的登录密码","")});if(!l)return void setTimeout(function(){return c.default.alert("请输入正确的身份验证码","")});if(!this.refs.protocol.checked)return void setTimeout(function(){return c.default.alert("请勾选同意《用户使用协议》","")});this.setState({isStart:!0});var s=void 0;(0,i.submitTaskHelper)({taskType:"zhengxin",username:r,password:n,code:l}).then(function(t){if(s=t,t.body.task_id){e.setState({isStart:!1}),c.default.refreshStatus("2","创建任务成功"),c.default.mxSaveTaskId(t.body.task_id);var n={taskId:t.body.task_id,username:r,mappingId:t.body.mapping_id,taskType:"zhengxin",loginParam:{account:r}};a(n)}}).catch(function(t){e.setState({isStart:!1});var a=t&&t.response&&t.response.body||{};a.errors&&a.errors[0]&&(10220011===a.errors[0].code||10220012===a.errors[0].code)?(c.default.refreshStatus("-2",a.errors[0].message),e.showUnsupport(a.errors[0].message)):(c.default.refreshStatus("-3","服务异常，创建任务失败"),e.handleError(t,a.detail))})},handleError:function(e){var t=arguments.length<=1||void 0===arguments[1]?"任务提交失败":arguments[1];try{t=e&&e.body&&e.body.detail||t}catch(e){}if("任务提交失败"==t){if(e&&e.message&&e.message.indexOf("the network is offline")!=-1)return void c.default.alert("网络开小差啦，请稍后再试");c.default.alert(t+"\n"+e)}else c.default.alert(t);this.setState({isStart:!1})},handleProtocol:function(){var e=c.default.Device.SDK?0:o.qsParams.showTitleBar,t=o.qsParams.themeColor,a=o.qsParams.agreementUrl&&"undefined"!=o.qsParams.agreementUrl?o.qsParams.agreementUrl:"https://api.51datakey.com/h5/agreement.html?showTitleBar="+e+"&themeColor="+t;c.default.openWebView("用户使用协议",a,"","agreement")},handleJumpPage:function(){c.default.openWebView("人行征信注册","https://ipcrs.pbccrc.org.cn/page/login/loginreg.jsp",'const registerbtn = document.getElementsByClassName("btn2")[1];if(registerbtn) registerbtn.click();')},handleForgetSMS:function(e){var t=n(e,3),a=t[0],r=t[1],l=t[2];c.default.confirm(r,"","取消,发送",function(e){2==e&&((0,o.isIOS)()?window.location.href="sms:"+l+"&body="+a:window.location.href="sms:"+l+"?body="+a)})},showUnsupport:function(e){this.setState({unsupport:e||this.state.unsupport,showUnsupport:!0})}});t.default=P,e.exports=t.default}).call(this)}finally{}}});