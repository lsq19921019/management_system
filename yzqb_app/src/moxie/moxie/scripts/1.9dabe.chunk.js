webpackJsonp([1,22,41],{15:function(e,t,a){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=function(e,t,a){for(var n=!0;n;){var o=e,s=t,r=a;n=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,s);if(void 0!==i){if("value"in i)return i.value;var l=i.get;if(void 0===l)return;return l.call(r)}var u=Object.getPrototypeOf(o);if(null===u)return;e=u,t=s,a=r,n=!0,i=u=void 0}},u=a(2),d=n(u),c=a(16),p=a(10),f=(n(p),a(1)),m=function(e){function t(e,a){s(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,a),this.state={}}return r(t,e),i(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.showTips,a=e.showOrHideSpinner,n=e.size,s=e.color,r=e.boxSize,i=(o(e,["showTips","showOrHideSpinner","size","color","boxSize"]),{display:a,width:"100%",maxWidth:f.qsParams.maxWidth?f.qsParams.maxWidth:"800px",height:f.qsParams.height?f.qsParams.height+"px":"100%",position:"fixed",right:0,bottom:0,margin:"0 auto",left:0,top:0,zIndex:996,background:"rgba(0,0,0,.4)"});return d.default.createElement("div",{style:i},d.default.createElement("div",{className:"SpinerBox",style:{overflow:"hidden",background:"rgba(22,22,22,0.8)",position:"absolute",top:"40%",left:"50%",width:""+r,height:""+r,borderRadius:"10px"}},d.default.createElement("div",{className:"newSpiner",style:{top:t?r/6+"px":(r-n)/2+"px"}},d.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",width:n,height:n,fill:s},d.default.createElement("path",{opacity:".25",d:"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4"}),d.default.createElement("path",{d:"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z"}))),d.default.createElement("div",{style:{color:"#fff",textAlign:"center",width:"100%",fontSize:"13px",position:"absolute",top:""+2*r/3}},t)))}}]),t}(d.default.Component);t.default=m,m.contextTypes={history:function(){return c.PropTypes.history}},m.defaultProps={boxSize:120,size:48,showTips:"正在加载",color:"#fff"},e.exports=t.default}).call(this)}finally{}},17:function(e,t,a){try{(function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e={DEFAULT:"DEFAULT",SUCC:"SUCC",FAIL:"FAIL"};t.TASK_STATUS=e}).call(this)}finally{}},19:function(e,t,a){try{(function(){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=e.task,a=e.callbacks;a=l({waitCode:u.noop,doneSucc:u.noop,doneFail:u.noop,doneTimeout:u.noop,doneLogin:u.noop,pendingTimeout:u.noop,doing:u.noop,error:u.noop,spiner:u.noop,showProgress:u.noop,importSucc:u.noop,onError:u.noop,errorCatch:u.noop,refreshImgCode:u.noop,setqrCodeTaskInfo:u.noop,doneScan:u.noop,zxBankSpiner:u.noop,showQrcodeInCrawlStatus:u.noop,hideQrCode:u.noop},a);var c,p=o(t),f=u.request.get(p+("?d="+Date.now())).set(l({},m.default.addDefaultHeaders())).set("Accept","application/json").set("Cache-Control","no-store");return c="carrier"==t.taskType?(0,u.guardTimeoutLongtime)(f):(0,u.guardTimeout)(f),c.then(function(e){var o=!1;if(a.setqrCodeTaskInfo&&"qrcode"==t.loginType&&a.setqrCodeTaskInfo(t),a.showProgress&&a.showProgress(e.body.description),"LOGIN"!=e.body.phase&&(a.doneLogin&&(o=a.doneLogin(t,e.body)),"alipay"==t.taskType&&"WAIT_CODE"!=e.body.phase_status&&a.hideQrCode&&a.hideQrCode(),s(t),(d.qsParams.quitOnLoginDone||d.qsParams.canLeave)&&"zhengxin"!=t.taskType))return o=!0,!1;switch("LOGIN"==e.body.phase&&"WAIT_CODE"!=e.body.phase_status&&a.doneScan&&a.doneScan(),e.body.phase_status){case b.WAIT_CODE:a.spiner&&a.spiner(),a.zxBankSpiner&&a.zxBankSpiner(),a.waitCode&&(o=a.waitCode(t,e.body));break;case b.CONTINUE:a.spiner&&a.spiner(),a.zxBankSpiner&&a.zxBankSpiner(),a.waitCode&&a.waitCode(t,e.body);break;case b.DONE_SUCC:e.body.finished===!0?(a.zxBankSpiner&&a.zxBankSpiner(),storage.setItem(t.taskType+"ImportStatus","succ"),setTimeout(function(){a.spiner&&a.spiner(),a.showProgress&&a.showProgress(""),k.default.refreshStatus("1",e.body.description)},3e3),a.importSucc&&a.importSucc(e.body),a.doneSucc&&a.doneSucc(t,e.body),o=!0,r(t)):a.doing&&(o=a.doing(t,e.body));break;case b.DONE_FAIL:a.hideQrCode&&a.hideQrCode(),storage.setItem(t.taskType+"ImportStatus","fail"),"LOGIN"===e.body.phase?("BALO-23001-10"==e.body.error_code&&a.doneTimeout&&a.doneTimeout(t,e.body),a.refreshImgCode(),k.default.refreshStatus("-4",e.body.description)):k.default.refreshStatus("0",e.body.description),a.zxBankSpiner&&a.zxBankSpiner(),setTimeout(function(){a.spiner&&a.spiner(),a.showProgress&&a.showProgress("")},3e3),a.doneFail&&a.doneFail(t,e.body),o=!0,i(t,e);break;case b.DONE_TIMEOUT:a.hideQrCode&&a.hideQrCode(),storage.setItem(t.taskType+"ImportStatus","fail"),"LOGIN"===e.body.phase?k.default.refreshStatus("-4",e.body.description,t.loginType,e.body.phase):k.default.refreshStatus("0",e.body.description,t.loginType,e.body.phase),a.doneTimeout&&a.doneTimeout(t,e.body),o=!0,i(t,e);break;case b.DOING:k.default.refreshStatus("2",e.body.description,t.loginType,e.body.phase),a.doing&&(o=a.doing(t,e.body));break;default:k.default.refreshStatus("-3","异常错误"),a.doneFail&&a.doneFail(t,e.body),o=!0,i(t,e)}"LOGIN"!=e.body.phase,o||setTimeout(function(){n({task:t,callbacks:a})},v)}).catch(function(e){var n=e&&e.body&&e.body.detail||e;k.default.alert("服务异常，请稍候再试！"+n),a.zxBankSpiner&&a.zxBankSpiner(),a.spiner&&a.spiner(),a.onError&&a.onError(t,e),a.error&&a.error(t,e),a.errorCatch&&a.errorCatch(e)})}function o(e){var t="";return t="bank"==e.taskType?p.default.checkImportState.replace("{taskid}",e.taskId):"carrier"==e.taskType?p.default.checkCarrierImportStatev2.replace("{taskid}",e.taskId):"chsi"==e.taskType?p.default.checkChsiImportState.replace("{taskid}",e.taskId):"fund"==e.taskType?p.default.checkFundImportState.replace("{taskid}",e.taskId):"email"==e.taskType||"qq"==e.taskType?p.default.checkEmailImportState.replace("{taskid}",e.taskId):"tax"==e.taskType?p.default.taxStatus.replace("{task_id}",e.taskId)+("?d="+Date.now()):"security"==e.taskType?p.default.checkSecurityImportState.replace("{taskid}",e.taskId)+("?d="+Date.now()):"alipay"==e.taskType||"wechat"==e.taskType?p.default.commonImportStateUrlv2.replace("{taskid}",e.taskId):"sametrade"==e.taskType?p.default.checkSametradeTaskStatus.replace("{task_id}",e.taskId):p.default.commonImportStateUrl.replace("{taskid}",e.taskId)}function s(e){k.default.mxHideWebView(),k.default.mxCanLeave(!0),k.default.loginDone=1,(d.qsParams.canLeave||d.qsParams.quitOnLoginDone)&&"zhengxin"!=e.taskType&&(console.log("finishImport"),k.default.finishImport(e.taskId,"2","登录认证成功","SUCC"),(0,g.default)({taskType:e.taskType}))}function r(e){k.default.finishImport(e.taskId,"1","认证成功","SUCC"),(0,g.default)({taskType:e.taskType})}function i(e,t){console.log("handleDoneFail"),"LOGIN"===t.body.phase?"zhengxin"!=e.taskType&&("qrcode"==e.loginType&&"DONE_TIMEOUT"==t.body.phase_status||k.default.alert(t.body.description)):(k.default.finishImport(e.taskId,"0",t.description,"FAIL"),d.qsParams.quitOnFail&&(0,g.default)({taskType:e.taskType}))}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},u=a(1),d=a(1),c=a(25),p=e(c),f=a(12),m=e(f),h=a(29),g=e(h),y=a(4),k=e(y),v=2500,b={DOING:"DOING",WAIT_CODE:"WAIT_CODE",DONE_SUCC:"DONE_SUCC",DONE_FAIL:"DONE_FAIL",DONE_TIMEOUT:"DONE_TIMEOUT"};t.STATE=b,t.default=n}).call(this)}finally{}},21:function(e,t,a){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=function(e,t,a){for(var n=!0;n;){var o=e,s=t,r=a;n=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,s);if(void 0!==i){if("value"in i)return i.value;var l=i.get;if(void 0===l)return;return l.call(r)}var u=Object.getPrototypeOf(o);if(null===u)return;e=u,t=s,a=r,n=!0,i=u=void 0}},l=a(2),u=n(l),d=function(e){function t(e,a){o(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,a)}return s(t,e),r(t,null,[{key:"propTypes",value:{desc:l.PropTypes.string.isRequired},enumerable:!0}]),r(t,[{key:"render",value:function(){var e=u.default.createElement("img",{style:{width:"350px"},src:a(45)});return u.default.createElement("div",{className:"waiting-view"},u.default.createElement("h3",{style:{width:"80%",textAlign:"center",fontSize:"16px",color:"#70BEEB",height:"50px",lineHeight:"50px",borderBottom:"1px solid #efeff4"}},"获取结果中..."),u.default.createElement("h4",{style:{height:"20px",fontSize:"14px",color:"#666666"}},this.props.desc),u.default.createElement("div",{className:"waiting-gif"},e))}}]),t}(u.default.Component);t.default=d,e.exports=t.default}).call(this)}finally{}},22:function(e,t,a){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=function(e,t,a){for(var n=!0;n;){var o=e,s=t,r=a;n=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,s);if(void 0!==i){if("value"in i)return i.value;var l=i.get;if(void 0===l)return;return l.call(r)}var u=Object.getPrototypeOf(o);if(null===u)return;e=u,t=s,a=r,n=!0,i=u=void 0}},l=a(2),u=n(l),d=a(1),c=a(23),p=a(5),f=n(p),m=(a(17),function(e){function t(e,a){o(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,a),this.state={}}return s(t,e),r(t,null,[{key:"propTypes",value:{succ:l.PropTypes.bool.isRequired,taskInfo:l.PropTypes.any.isRequired,canQuitAuth:l.PropTypes.bool},enumerable:!0}]),r(t,[{key:"render",value:function(){var e=this,t={color:void 0!=d.qsParams.themeColor?"#"+d.qsParams.themeColor:c.DEFAULT_THEMECOLOR,fontSize:"12px"},a=void 0!=d.qsParams.themeColor?"#"+d.qsParams.themeColor:c.DEFAULT_THEMECOLOR,n=null;return n=this.props.succ?u.default.createElement("div",{className:"finish-status succ"},u.default.createElement("svg",{width:"48",height:"48",viewBox:"0 0 48 48"},u.default.createElement("g",{className:"transform-group"},u.default.createElement("g",{transform:"scale(0.046875, 0.046875)"},u.default.createElement("path",{d:"M511.996387 9.862132c-277.328216 0-502.134255 224.813265-502.134255 502.137868 0 277.328216 224.80604 502.137868 502.134255 502.137868 277.320991 0 502.137868-224.809652 502.137868-502.137868C1014.137868 234.675397 789.320991 9.862132 511.996387 9.862132L511.996387 9.862132zM824.889692 388.748635l-351.388132 338.834686c-4.670966 4.663741-9.952445 8.337656-15.587949 11.028971-22.065166 15.761349-52.915939 13.75641-72.730516-6.061779l-150.897848-150.897848c-22.065166-22.065166-22.065166-57.832555 0-79.883271 22.054329-22.065166 57.821717-22.065166 79.886884 0l113.291695 113.28447 317.531758-306.192112c22.061554-22.061554 57.832555-22.061554 79.883271 0C846.954858 330.919692 846.954858 366.687081 824.889692 388.748635L824.889692 388.748635zM824.889692 388.748635",fill:a})))),u.default.createElement("p",{style:t},"验证成功"),d.qsParams.token?u.default.createElement(f.default,{types:"full",style:"width:50%;height:44px;",onTap:function(){e.onSuccDetailButtonClick()}},"详情查询"):null):u.default.createElement("div",{className:"finish-status fail"},u.default.createElement("i",{className:"import-fail-img"}),u.default.createElement("p",{className:"fail-desc",style:{marginBottom:"20px"}},this.props.desc),"YES"!=d.qsParams.notRetryOnFail&&1!=d.qsParams.notRetryOnFail?u.default.createElement(f.default,{types:"full",style:"width:50%;height:44px;",onTap:function(){e.retryButtonClick()}},"点击重试"):null),u.default.createElement("div",{className:"waiting-view"},u.default.createElement("div",{className:"waiting-gif"},n))}},{key:"retryButtonClick",value:function(){window.location.reload()}},{key:"retryButtonClick",value:function(){window.location.reload()}},{key:"onSuccDetailButtonClick",value:function(){if(void 0==d.qsParams.token)return void PG.alert("缺少token值");var e=this.props.taskInfo,t=(0,d.getENV)(),a="";a="test"==t?"http://192.168.0.11:8282":"pre"==t||"qa"==t?"https://qa.51datakey.com":"https://api.51datakey.com";var n="";switch(e.taskType){case"email":n=a+"/h5/resultV3/index.html#/emailResult?taskId="+e.taskId+"&token="+d.qsParams.token+"&mainTitle="+d.qsParams.mainTitle+"&icoUrl="+d.qsParams.icoUrl;break;case"bank":n=a+"/h5/resultV3/index.html#/bankResult/?taskId="+e.taskId+"&token="+d.qsParams.token+"&mainTitle="+d.qsParams.mainTitle+"&icoUrl="+d.qsParams.icoUrl;break;case"carrier":n=a+"/h5/resultV4/carrier/index.html?taskId="+e.account+"&token="+d.qsParams.token+"&mainTitle="+d.qsParams.mainTitle+"&icoUrl="+d.qsParams.icoUrl;break;case"shixin":n=a+"/h5/resultV4/shixin/index.html?taskId="+e.taskId+"&token="+d.qsParams.token+"&mainTitle="+d.qsParams.mainTitle+"&icoUrl="+d.qsParams.icoUrl;break;case"tax":n=a+"/h5/resultV4/tax/index.html?taskId="+e.taskId+"&token="+d.qsParams.token+"&mainTitle="+d.qsParams.mainTitle+"&icoUrl="+d.qsParams.icoUrl;break;case"zhixing":n=a+"/h5/resultV4/zhixing/index.html?taskId="+e.taskId+"&token="+d.qsParams.token+"&mainTitle="+d.qsParams.mainTitle+"&icoUrl="+d.qsParams.icoUrl;break;default:n=a+"/h5/resultV3/index.html#/"+e.taskType+"?taskId="+e.taskId+"&token="+d.qsParams.token+"&mainTitle="+d.qsParams.mainTitle+"&icoUrl="+d.qsParams.icoUrl}"test"==t?n+="&env=test":"pre"!=t&&"qa"!=t||(n+="&env="+t),window.location.href=n}}]),t}(u.default.Component));t.default=m,e.exports=t.default}).call(this)}finally{}},23:function(e,t,a){try{(function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e="#58B5EB";t.DEFAULT_THEMECOLOR=e}).call(this)}finally{}},24:function(e,t,a){try{(function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e={LOGIN:"LOGIN",RECEIVE:"RECEIVE",EXTRACT:"EXTRACT",STORE:"STORE",DONE:"DONE"};t.PHASE=e}).call(this)}finally{}},61:function(e,t,a){e.exports=a.p+"assets/dce45f5d.download.gif"},62:function(e,t,a){e.exports=a.p+"assets/a44566d4.invalid.png"},112:function(e,t,a){t=e.exports=a(93)(!1),t.push([e.id,".input-items-box{border-bottom:1px solid #ededed;padding-left:10px;background-color:#fff}.input-items{position:relative;padding:0;height:45px}.input-items,.input-items .mx-input{box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-moz-flex;display:-ms-flexbox;display:flex}.input-items .mx-input{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-moz-flex:1;-ms-flex:1;flex:1}.input-items .mx-input label{height:43px;min-width:70px;font-size:13px;margin-top:auto;margin-bottom:auto}.input-items .mx-input .mx-input-main{height:49px}.input-items .mx-input .mx-input-main,.input-items .mx-input input{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-moz-flex:1;-ms-flex:1;flex:1;box-sizing:border-box}.input-items .mx-input input{font-size:14px;border:none;outline:none;height:43px;position:relative;display:block;width:100%}.input-items .input-item-tips{font-size:11px;color:#666;padding-bottom:10px}.log-right{color:#d9d9d9}.log-right,.log-wrong{font-size:11px;padding-bottom:5px;margin-left:5px}.log-wrong{color:#f17283}",""])},118:function(e,t,a){var n=a(112);"string"==typeof n&&(n=[[e.id,n,""]]);var o,s={};s.transform=o,a(99)(n,s),n.locals&&(e.exports=n.locals)},144:function(e,t,a){e.exports=a.p+"assets/c074743e.bankScanCode.jpg"},145:function(e,t,a){e.exports=a.p+"assets/35417770.zhiyinStep1.jpg"},222:function(e,t,a){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(2),s=n(o),r=a(8),i=a(14),l=n(i),u=a(1),d=a(40),c=a(4),p=n(c),f=a(164),m=n(f),h=a(10),g=n(h),y=a(13),k=n(y),v=a(5),b=n(v),T=a(11),E=(n(T),a(41)),C=n(E),I=a(12),_=n(I);a(118);var S="#58B5EB",x="https://api.51datakey.com/h5/static/bank_icon/bank_icon_{bankMark}.png",w=s.default.createClass({displayName:"ImportForm",getInitialState:function(){return{loginTypeIndex:0,login:!0,Type:"password",bgImg:"url("+a(20)+")",qrcodeTimeout:!1,qrcodeValue:null,showQRCodeInstruction:!1,gettingCode:!1,cardType:this.props.cardType,bankId:this.props.bankId,frontConf:this.props.frontConf,isRight0:!0,isRight1:!0,isRight2:!0}},componentDidMount:function(){var e=this;this.onSubmitTaskDone,document.activeElement&&document.activeElement.blur();var t=this.props,a=t.pageConfig,n=(t.poll,(0,d.getParams)("loginParams"));n&&"undefined"!=n&&n[a.login_type]&&(n[a.login_type].username&&n[a.login_type].password&&!n[a.login_type].username1||n[a.login_type].username1&&n[a.login_type].username&&n[a.login_type].password)&&(this.timer=setInterval(function(){n[a.login_type].username1?""!=e.refs[a.login_type+"input0"].getValue()&&""!=e.refs[a.login_type+"input1"].getValue()&&""!=e.refs[a.login_type+"input2"].getValue()&&(clearInterval(e.timer),e.handleImport()):""!=e.refs[a.login_type+"input0"].getValue()&&""!=e.refs[a.login_type+"input2"].getValue()&&(clearInterval(e.timer),e.handleImport())},100)),"QRCODE"==a.login_type,this.isMounted=!0;var o=0;this.setState({loginTypeIndex:o})},componentWillUnmount:function(){this.isMounted=!1,clearInterval(this.timer)},render:function(){var e=this,t=this.handleImport,a=this.renderLoginTypeTabs,n=this.renderInputs,o=this.tryGetCachedValue,r=(o("password"),this.props.pageConfig),i=a(),l=n();if(this.props.pageConfig.notice)var d=JSON.parse(this.props.pageConfig.notice).content,c=JSON.parse(this.props.pageConfig.notice).title;var p=s.default.createElement("div",{className:"config-import-page"},this.props.pageConfig.notice?s.default.createElement("div",{style:{fontSize:"12px",marginBottom:"30px"}},s.default.createElement(m.default,{content:d,height:"30px",top:"0px",title:c})):null,i,l.length>0?s.default.createElement("div",{className:"form",style:{width:"100%"}},l):null,"QRCODE"!=r.login_type?s.default.createElement("div",null,s.default.createElement("div",{className:"login-other-items"},s.default.createElement(C.default,{ref:"agreementField",uid:r.login_type,frontConf:this.state.frontConf}),s.default.createElement("div",{style:{float:"right",fontSize:"12px",color:u.qsParams.themeColor?"#"+u.qsParams.themeColor:"#5e82fb",padding:"0 15px"}},(this.props.pageConfig.mx_forget_password_url||this.props.pageConfig.forget_password_url)&&"1"==this.state.frontConf.showMoreInformation?s.default.createElement(g.default,{onTap:function(){return e.handleLink(3)}},s.default.createElement("span",null,"找回密码")):null,(this.props.pageConfig.mx_forget_password_url||this.props.pageConfig.forget_password_url)&&"1"==this.state.frontConf.showMoreInformation&&(this.props.pageConfig.mx_forget_username_url||this.props.pageConfig.forget_username_url)?s.default.createElement("span",null," / "):null,(this.props.pageConfig.mx_forget_username_url||this.props.pageConfig.forget_username_url)&&"1"==this.state.frontConf.showMoreInformation?s.default.createElement(g.default,{onTap:function(){return e.handleLink(4)}},s.default.createElement("span",null,"找回用户名")):null)),s.default.createElement("div",{className:"page-wrapper"},s.default.createElement(g.default,{onTap:t},s.default.createElement(b.default,{types:"full",disable:this.state.login,state:this.state.login,onTap:function(){},getState:function(e){switch(e){case!0:return"提交";default:return"提交"}}}))),s.default.createElement("div",{style:{color:u.qsParams.themeColor?"#"+u.qsParams.themeColor:"#5e82fb"},className:"link-wrapper"},this.props.pageConfig.login_url&&"1"==this.state.frontConf.showMoreInformation?s.default.createElement("div",{onClick:function(){e.handleLink(2)}},s.default.createElement("span",{className:"ion-ios-world"}),s.default.createElement("a",{style:{color:u.qsParams.themeColor?"#"+u.qsParams.themeColor:"#5e82fb"}},"前往官网")):null,this.props.pageConfig.mx_register_url&&"1"==this.state.frontConf.showMoreInformation?s.default.createElement("div",{onClick:function(){e.handleLink(1)}},s.default.createElement("span",{className:"ion-ios-redo-outline"}),s.default.createElement("a",{style:{color:u.qsParams.themeColor?"#"+u.qsParams.themeColor:"#5e82fb"}},"开通网银")):null)):null);return s.default.createElement("div",null,p,"QRCODE"==r.login_type?s.default.createElement("div",null,this.state.showQRCodeInstruction?s.default.createElement("div",{style:{position:"fixed"},className:"vcode-tips-bg",onClick:function(){e.setState({showQRCodeInstruction:!1})}},s.default.createElement("div",{className:"iknow-button"},"我知道了"),this.renderInstructionView()):null):null)},handleLink:function(e){var t=this.context.history.pushState,a=window.location.protocol+"//"+window.location.host+window.document.location.pathname+"#",n=this.props.pageConfig.register_url,o=this.props.pageConfig.forget_password_url,s=this.props.pageConfig.forget_username_url,r=function(){return(_.default.apiToken?"apitoken="+_.default.apiToken:"apikey="+_.default.apiKey)+"&userId="+u.qsParams.userId+"&themeColor="+u.qsParams.themeColor};switch(this.props.pageConfig.mx_register_url&&(n=a+this.props.pageConfig.mx_register_url+"?"+r()),this.props.pageConfig.mx_forget_password_url&&(o=a+this.props.pageConfig.mx_forget_password_url+"?"+r()),this.props.pageConfig.mx_forget_username_url&&(s=a+this.props.pageConfig.mx_forget_username_url+"?"+r()),e){case 1:p.default.openWebView("开通网银",n,"","");break;case 2:p.default.openWebView("网银登录",this.props.pageConfig.login_url,"","");break;case 3:p.default.openWebView("找回密码",o,"","");break;case 4:p.default.openWebView("找回用户名",s,"","");break;case 5:"1"==this.state.frontConf.showHelpInIframe?(u.qsParams.url=encodeURIComponent(this.props.pageConfig.help_url),t({title:"帮助"},"/otherView",u.qsParams)):p.default.openWebView("帮助",this.props.pageConfig.help_url,"","")}},renderLoginTypeTabs:function(){var e=(this.selectLoginType,this.state.loginTypeIndex,this.props.pageConfig,null),t=100..toFixed(2);return{backgroundColor:u.qsParams.themeColor?"#"+u.qsParams.themeColor:S,width:t+"%",borderRight:"1px solid #"+u.qsParams.themeColor},{color:"#"+u.qsParams.themeColor,backgroundColor:"white",width:t+"%",borderRight:"1px solid #"+u.qsParams.themeColor},{borderColor:"#"+u.qsParams.themeColor},e},renderInputs:function(){var e,t=this,a=this.tryGetCachedValue,n=this.wrapValidator,o=(this.getPasswordCache,this.state.loginTypeIndex,this.props.pageConfig),r=a("username"),i=a("password");if(o.username1_desc){e=r;var l=r.indexOf(",");r=r.substring(0,l),e=e.substring(l+1)}var c=!1,p=(0,d.getParams)("loginParams")?(0,d.getParams)("loginParams"):{};p[o.login_type]&&(c=!0);var f=[];if("QRCODE"!=o.login_type)for(var m=0;m<3;m++){var h=null;h=0==m?s.default.createElement("div",{className:"input-items-box"},s.default.createElement("div",{className:"input-items",key:o.login_type+"input"+m},s.default.createElement(k.default,{key:o.login_type+"input"+m,type:"text",ref:o.login_type+"input"+m,defaultValue:c&&p[o.login_type].username?p[o.login_type].username:r,placeholder:o.username_desc,validator:n(o.username_regex),onChanges:function(e){return t.changeCon(e,0,o.username_regex,o.username1_desc)},disabled:!!c&&!!p[o.login_type].username}),m>0?null:this.props.pageConfig.help_url?s.default.createElement("div",{onClick:function(){return t.handleLink(5)},className:"d-tiao"},"帮助",s.default.createElement("span",{style:{fontSize:"18px",color:u.qsParams.themeColor?"#"+u.qsParams.themeColor:"#5e82fb"},className:"ion-ios-help-outline"})):null),s.default.createElement("div",{className:this.state.isRight0?"log-right":"log-wrong"},o.username_tips)):1==m?o.username1_desc?s.default.createElement("div",{className:"input-items-box"},s.default.createElement("div",{className:"input-items",key:o.login_type+"input"+m},s.default.createElement(k.default,{key:o.login_type+"input"+m,type:"text",ref:o.login_type+"input"+m,defaultValue:c&&p[o.login_type].username1?p[o.login_type].username1:e,placeholder:o.username1_desc,validator:n(o.username1_desc),onChanges:function(e){return t.changeCon(e,1,o.username1_regex,o.username1_desc)},disabled:!!c&&!!p[o.login_type].username1})),s.default.createElement("div",{className:this.state.isRight1?"log-right":"log-wrong"},o.username1_tips)):null:s.default.createElement("div",{className:"input-items-box"},s.default.createElement("div",{className:"input-items",key:o.login_type+"input"+m},s.default.createElement(k.default,{key:o.login_type+"input"+m,type:this.state.Type,ref:o.login_type+"input"+m,defaultValue:c&&p[o.login_type].password?p[o.login_type].password:i,placeholder:o.password_desc,validator:n(o.password_regex),onChanges:function(e){return t.changeCon(e,2,o.password_regex,o.username1_desc)},disabled:!!c&&!!p[o.login_type].password}),s.default.createElement("div",{onClick:this.showPwd,className:"tex_box"},s.default.createElement("span",{style:{backgroundImage:this.state.bgImg},className:"password password_show"}))),s.default.createElement("div",{className:this.state.isRight2?"log-right":"log-wrong"},o.password_tips)),f.push(h)}else{var g=this.renderQRCode();f.push(g)}return f},renderQRCode:function(){var e=this,t=this.props,n=t.qrcodeValue,o=t.qrcodeTimeout,r=t.getQrcodeError,i=t.bankId;return s.default.createElement("div",null,s.default.createElement("div",{className:"qrcode-login"},s.default.createElement("div",{className:"qrcode-title"},function(){return null==n?e.state.gettingCode?o?r?"获取二维码失败":"二维码超时":"正在获取二维码":"点击图片获取二维码":"扫码授权"}()),s.default.createElement("div",{className:"qrcode-content"},this.state.gettingCode?null:s.default.createElement(g.default,{onTap:function(){e.createBankQrcodeTask()}},s.default.createElement("div",null,s.default.createElement("img",{className:"qrcode-center",src:x.replace("{bankMark}",i)}))),n?s.default.createElement(g.default,{onPress:function(t){e.onPressImg(n),t.preventDefault()}},s.default.createElement("div",null,s.default.createElement("img",{className:"qrcode-image",src:"data:image/png;base64,"+n}))):s.default.createElement(g.default,{onTap:function(){o&&e.createBankQrcodeTask()}},s.default.createElement("div",{className:"qrcode-image"},o?s.default.createElement("div",{className:"qrcode-retry-button"},"点击重新获取"):null)),function(){return null==n&&e.state.gettingCode?o?s.default.createElement(g.default,{onTap:function(){o&&e.createBankQrcodeTask()}},s.default.createElement("img",{className:"qrcode-center",src:a(62)})):s.default.createElement("img",{className:"qrcode-center",src:x.replace("{bankMark}",i)}):null}(),n||o||!this.state.gettingCode?null:s.default.createElement("img",{className:"qrcode-center-circle",src:a(61)})),s.default.createElement("div",{className:"qrcode-instruction"},s.default.createElement("div",{className:"qrcode-instruction-text"},p.default.Device.Mobile?!p.default.Device.Wechat&&u.BankApplink[i]&&u.BankApplink[i].link?"1.长按或截图保存二维码\r\n2.请点击扫一扫进行扫码授权\r\n3.扫码后请稍作等待":'1.长按或截图保存二维码\r\n2.打开APP"'+u.BankApplink[i].appName+'"进行扫码授权\r\n3.扫码后请稍作等待':'1.请打开手机APP"'+u.BankApplink[i].appName+'"扫码\r\n2.扫码后请稍作等待')),n?s.default.createElement("div",{className:"vcode-dialog-body-operation",style:{padding:0}},s.default.createElement("div",{className:"operation-main"},s.default.createElement(b.default,{types:"small outline",onTap:function(){e.setState({showQRCodeInstruction:!0})}},"查看指引"),p.default.Device.Mobile&&!p.default.Device.Wechat&&u.BankApplink[i]&&u.BankApplink[i].link?s.default.createElement(b.default,{types:"small outline",onTap:function(){p.default.mxOpenUrl({url:u.BankApplink[i].link})}},"扫一扫"):null)):null))},handleImport:function(){function e(){l.default.set("bank",s,f,o.login_type,{loginParamAccount:c,loginFail:!0})}var t=this;if(!this.state.login){var a=this.onSubmitTaskDone,n=this.props,o=n.pageConfig,s=n.bankId;if(n.onImport,this.state.loginTypeIndex,!this.refs.agreementField.isChecked(E.AGREEMENT_TYPE.MOXIE))return void setTimeout(function(){return p.default.alert("请勾选同意《用户使用协议》","")});if(!this.refs.agreementField.isChecked(E.AGREEMENT_TYPE.TENANT))return void setTimeout(function(){return p.default.alert("请勾选同意《用户使用协议》","")});var i=this.refs.agreementField.isChecked(E.AGREEMENT_TYPE.PASSWORD),d={username:this.refs[o.login_type+"input0"].getValue(),password:this.refs[o.login_type+"input2"].getValue()},c={username:this.refs[o.login_type+"input0"].getValue()};if(d.account=d.username,!new RegExp(o.username_regex).test(d.account))return void setTimeout(function(){return p.default.alert("请输入正确的账号")});if(!new RegExp(o.password_regex).test(d.password))return void setTimeout(function(){return p.default.alert("密码不符合要求，请重新输入")});if(o.username1_desc&&(d.username1=this.refs[o.login_type+"input1"].getValue(),d.account=d.account+","+d.username1,!new RegExp(o.username1_regex).test(d.username1)))return void setTimeout(function(){return p.default.alert("请输入正确的卡号")});this.setState({login:!0});var f=this.props.cardType||u.qsParams.cardType;(0,r.submitTaskHelper)({taskType:"bank",taskSubType:s,loginTarget:f,loginType:o.login_type,username:d.account,password:d.password,rmbPwd:i?"1":"0"}).then(function(e){if(t.setState({login:!1}),e.body.task_id){p.default.refreshStatus("2","创建任务成功"),p.default.mxSaveTaskId(e.body.task_id);var n={taskId:e.body.task_id,bankId:s,loginTarget:f,loginType:o.login_type,taskType:"bank",loginParam:{username:d.account}};a(n)}}).catch(function(a){t.setState({login:!1}),p.default.refreshStatus("-3","服务异常，创建任务失败"),e(),t.handleError(a)})}},changeCon:function(e,t,a,n){0==t?new RegExp(a).test(e.target.value)?this.setState({isRight0:!0}):this.setState({isRight0:!1}):1==t?new RegExp(a).test(e.target.value)?this.setState({isRight1:!0}):this.setState({isRight1:!1}):new RegExp(a).test(e.target.value)?this.setState({isRight2:!0}):this.setState({isRight2:!1});var o=this.props.pageConfig,s={username:this.refs[o.login_type+"input0"].getValue(),password:this.refs[o.login_type+"input2"].getValue()};s.account=s.username,o.username1_desc?(s.username1=this.refs[o.login_type+"input1"].getValue(),new RegExp(o.username_regex).test(s.account)&&new RegExp(o.password_regex).test(s.password)&&new RegExp(o.username1_regex).test(s.username1)?this.setState({login:!1}):this.setState({login:!0})):new RegExp(o.username_regex).test(s.account)&&new RegExp(o.password_regex).test(s.password)?this.setState({
login:!1}):this.setState({login:!0})},getLastLogin:function(){var e=this.props.cardType||u.qsParams.cardType,t=this.props,a=t.pageConfig,n=t.bankId;return l.default.get("bank",n,e,a.login_type)},showPwd:function(){"text"==this.state.Type?this.setState({Type:"password",bgImg:"url("+a(20)+")"}):this.setState({Type:"text",bgImg:"url("+a(36)+")"})},handleError:function(e){var t=e&&e.body&&e.body.detail||"网络异常，请稍后再试!\n"+e;p.default.alert(t)},onPressImg:function(e){try{"function"==typeof window.mxPostMessage&&window.mxPostMessage(JSON.stringify({type:"mxSaveImg",value:e,succText:"保存成功，请点击扫一扫进行扫码",failText:"保存失败，请截图后进行扫码"}))}catch(e){}},renderInstructionView:function(){var e=this.props.bankId;return p.default.Device.Mobile?s.default.createElement("div",{className:"instruction-view"},s.default.createElement("div",{className:"instruction-view-card"},s.default.createElement("div",{className:"text1"},"第一步"),s.default.createElement("div",{className:"text2"},"长按或截图保存二维码",s.default.createElement("br",null),"点击扫一扫跳转APP"),s.default.createElement("img",{src:a(145)})),p.default.Device.Wechat?s.default.createElement("div",{className:"instruction-view-card"},s.default.createElement("div",{className:"text1"},"第二步"),s.default.createElement("div",{className:"text2"},"打开APP的扫一扫功能"),s.default.createElement("img",{src:u.BankApplink[e]?u.BankApplink[e].instructionImg:""})):s.default.createElement("div",{className:"instruction-view-card"},s.default.createElement("div",{className:"text1"},"第二步"),s.default.createElement("div",{className:"text2"},"打开APP的扫一扫功能"),s.default.createElement("img",{src:u.BankApplink[e]?u.BankApplink[e].instructionImg:""})),s.default.createElement("div",{className:"instruction-view-card"},s.default.createElement("div",{className:"text1"},"第三步"),s.default.createElement("div",{className:"text2"},"打开相册，扫描二维码"),s.default.createElement("img",{src:a(144)}))):s.default.createElement("div",{className:"instruction-view",style:{width:"100%"}},s.default.createElement("div",{className:"instruction-view-card",style:{width:"100%"}},s.default.createElement("div",{className:"text2"},"打开APP的扫一扫功能进行扫描"),s.default.createElement("img",{src:u.BankApplink[e]?u.BankApplink[e].instructionImg:""})))},createBankQrcodeTask:function(){var e=this,t=this.onSubmitTaskDone,a=this.props,n=(a.pageConfig,a.bankId),o=(a.onImport,a.changeQRcodeTimeout);this.state.loginTypeIndex,o();var s=void 0,i=this.props.cardType||u.qsParams.cardType;this.setState({gettingCode:!0}),(0,r.submitTaskHelper)({taskType:"bank",taskSubType:n,loginTarget:i,loginType:"QRCODE",username:"QRCODE",password:"QRCODE"}).then(function(e){if(s=e,e.body.task_id){var a={taskId:e.body.task_id,bankId:n,loginTarget:i,taskType:"bank",loginType:"qrcode"};storage.setItem(n+"-"+i+"-bankQRCodeTask",JSON.stringify(a)),t(a)}}).catch(function(t){var a=t&&t.response&&t.response.body||{};a.errors&&a.errors[0]&&(10220011===a.errors[0].code||10220012===a.errors[0].code)?(p.default.refreshStatus("-2",a.errors[0].message),e.showUnsupport(a.errors[0].message)):(p.default.refreshStatus("-3","服务异常，创建二维码任务失败"),e.handleError(t,a.detail))})},selectLoginType:function(e){this.setState({loginTypeIndex:e})},onSubmitTaskDone:function(e){return e.importResult={},this.props.onSubmitTaskDone(e),!0},tryGetCachedValue:function(e){var t=this.getLastLogin();return t&&t.loginParam&&t.loginParam[e]?t.loginParam[e]:""},wrapValidator:function(e){return function(t){return""===t||new RegExp(e).test(t)}}});w.contextTypes={history:o.PropTypes.history},t.default=w,e.exports=t.default}).call(this)}finally{}},796:function(e,t,a){try{(function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e=function(e){switch(e){case"IDCARD":return"身份证";case"USERNAME":return"用户名";case"CLIENTNO":return"客户号";case"MOBILE":return"手机号码";case"CARDNO":return"卡号";case"CREDITCARDNO":return"信用卡卡号";case"DEBITCARDNO":return"储蓄卡卡号";case"TAOBAO":return"淘宝账号";case"ALIPAY":return"支付宝账号";case"JINGDONG":return"京东";case"EMAIL":return"邮箱";case"FUNDACCOUNT":return"住房公积金账号";case"QRCODE":return"二维码";default:return""}};t.getBankLoginNameByType=e}).call(this)}finally{}},800:function(e,t,a){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=function(e,t,a){for(var n=!0;n;){var o=e,s=t,r=a;n=!1,null===o&&(o=Function.prototype);var i=Object.getOwnPropertyDescriptor(o,s);if(void 0!==i){if("value"in i)return i.value;var l=i.get;if(void 0===l)return;return l.call(r)}var u=Object.getPrototypeOf(o);if(null===u)return;e=u,t=s,a=r,n=!0,i=u=void 0}},l=a(2),u=n(l),d=a(1),c=a(4),p=n(c),f=a(24),m=a(14),h=n(m),g=a(19),y=n(g),k=a(8),v=a(9),b=n(v),T=a(222),E=n(T),C=a(54),I=n(C),_=a(18),S=n(_),x=a(6),w=n(x),P=a(7),q=n(P),O=a(13),N=(n(O),a(5)),D=(n(N),a(11)),A=n(D),L=a(15),R=n(L),M=a(29),B=n(M),V=a(796),Q=a(21),U=n(Q),F=a(22),z=n(F),j=a(17),G=a(40),W=a(39),H=a(12),K=n(H),J="bankImportTask",Y="https://api.51datakey.com/h5/static/bank_icon/bank_icon_{bankMark}.png",X="此次尝试失败，请重试",Z="验证完成",$=!1,ee=function(e){function t(e,t){o(this,a),i(Object.getPrototypeOf(a.prototype),"constructor",this).call(this,e,t),this.state={selectedIndex:0,isLoading:!0,isInvalid:"YES"===d.qsParams.isInvalid||1==d.qsParams.isInvalid,bankInfo:null,pages:null,matchPages:[],title:"",taskInfo:"YES"===d.qsParams.continue||1==d.qsParams.continue?JSON.parse(storage.getItem(J)):null,taskStatus:j.TASK_STATUS.DEFAULT,desc:"",isLoginDone:!1,progress:0,bankName:"",hasQuit:!1,unsupportMessage:"抱歉，该银行服务暂不可用",stopPollingQrcode:!0,qrcodeValue:null,qrcodeTimeout:null,getQrcodeError:!1,isScanned:!1,frontConf:K.default.frontConf[K.default.taskType]}}s(t,e),r(t,null,[{key:"propTypes",value:{showVCodeModal:l.PropTypes.func,hideVCodeModal:l.PropTypes.func},enumerable:!0}]),r(t,[{key:"componentDidMount",value:function(){var e=this,t=this.props.params.bankId,a=this.props.params.cardType||d.qsParams.cardType;return t&&a?void(0,k.fetchLoginConfig)({taskType:"bank",bankMark:t,cardType:a}).then(function(t){var n=t.body,o=[];t.body.logins.map(function(e){1==e.status&&o.push(e)});var s="CREDITCARD"==a?"信用卡":"储蓄卡",r=n.bank_name+s;p.default.refreshTitle(r);var i=d.qsParams.loginOthersHide,l=!1,u={};(0,G.getParams)("loginParams")&&(l=!0,u=(0,G.getParams)("loginParams"));var c=o.filter(function(e){return!l||!(("YES"==i||1==i)&&void 0==u[e.login_type])});0==c.length?e.setState({bankInfo:n,pages:o,matchPages:c,title:r,isInvalid:!0,unsupportMessage:"抱歉，该银行暂不支持"}):(c.map(function(t,a){if(u&&"undefined"!=u)for(var n in u)n==t.login_type&&(e.state.selectedIndex=a)}),e.setState({bankInfo:n,pages:o,matchPages:c,title:r}))}).then(function(){e.setState({isLoading:!1})}).catch(function(t){console.log(t),e.setState({isInvalid:!0,isLoading:!1})}):void this.setState({isInvalid:!0})}},{key:"componentWillUnmount",value:function(){var e=this.props.params.bankId||d.qsParams.bank_id,t=this.props.params.cardType||d.qsParams.cardType;this.unmounted=!0,this.state.isLoginDone&&storage.removeItem(e+"-"+t+"-bankQRCodeTask")}},{key:"render",value:function(){var e=this,t=(this.state.bankInfo?this.state.bankInfo.bank_name:"",u.default.createElement("div",{className:"centered"},u.default.createElement(A.default,{size:"44",color:"#999"})));return this.state.pages&&this.state.pages.length>0&&(t=this.state.isLoginDone?this.state.taskStatus==j.TASK_STATUS.DEFAULT?u.default.createElement(U.default,{desc:this.state.desc}):u.default.createElement(z.default,{succ:this.state.taskStatus==j.TASK_STATUS.SUCC,taskInfo:this.state.taskInfo||this.state.qrCodeTaskInfo,desc:this.state.desc}):this.renderImportForms()),this.state.isInvalid&&(t=u.default.createElement("div",{className:"service-unsupport"},u.default.createElement("i",null),u.default.createElement("p",null,this.state.unsupportMessage))),this.state.isLoading&&!this.isQRCode()&&this.state.taskInfo&&(t=u.default.createElement("div",{className:"centered"},u.default.createElement(A.default,{size:"44",color:"#999"}))),u.default.createElement("div",{className:"import-onlinebank"},u.default.createElement("div",{className:"mx-view"},"NO"==d.qsParams.showTitleBar||0==d.qsParams.showTitleBar||p.default.Device.SDK?null:u.default.createElement("div",{style:{height:"NO"==d.qsParams.showTitleBar||0==d.qsParams.showTitleBar||p.default.Device.SDK?0:44}},u.default.createElement(w.default,{title:this.state.title,left:u.default.createElement(q.default,{onTap:function(){e.handleBack()}},u.default.createElement("i",{className:"ion-chevron-left"}))})),u.default.createElement(S.default,null,t)))}},{key:"renderImportForms",value:function(){var e=this,t=this.props.params.bankId||d.qsParams.bank_id,a=this.props.params.cardType||d.qsParams.cardType,n=u.default.createElement("div",null,u.default.createElement(I.default,{selectedIndex:this.state.selectedIndex,headerclass:"centerImgDiv-bank",onIndexChange:this.onIndexChange.bind(this)},this.state.matchPages.map(function(n,o){return u.default.createElement("div",{title:(0,V.getBankLoginNameByType)(n.login_type),key:o},u.default.createElement(E.default,{ref:"ImportForm-"+o,frontConf:e.state.frontConf,bankId:t,cardType:a,bankname:e.state.bankInfo.bank_name,pageConfig:n,onSubmitTaskDone:e.onSubmitTaskDone.bind(e),poll:y.default,qrcodeTimeout:e.state.qrcodeTimeout,qrcodeValue:e.state.qrcodeValue,getQrcodeError:e.state.getQrcodeError,changeQRcodeTimeout:e.changeQRcodeTimeout.bind(e)}))})),$?u.default.createElement("div",{style:{position:"absolute",top:"0",width:"100%",height:"100px",textAlign:"center"}},u.default.createElement("div",{style:{width:"2.5pc",height:"2.5pc",backgroundImage:"url("+Y.replace("{bankMark}",this.state.bankInfo.subtype)+")",backgroundSize:"2.5pc 2.5pc",marginLeft:"auto",marginRight:"auto",marginTop:"20px"}}),u.default.createElement("div",{style:{fontSize:"12px",marginTop:"5px",color:"white"}},this.state.title)):null,!this.isQRCode()&&this.state.taskInfo&&this.state.showSpiner||this.isQRCode()&&this.state.isScanned&&this.state.showSpiner&&this.state.qrcodeValue?u.default.createElement(R.default,{showTips:this.state.desc}):null);return n}},{key:"isQRCode",value:function(e){return this.state.matchPages.filter(function(e){return"1"==e.status})[e||this.state.selectedIndex]&&"QRCODE"==this.state.matchPages.filter(function(e){return"1"==e.status})[e||this.state.selectedIndex].login_type}},{key:"setqrCodeTaskInfo",value:function(e){this.setState({qrCodeTaskInfo:e})}},{key:"changeQRcodeTimeout",value:function(){this.setState({qrcodeTimeout:!1})}},{key:"onIndexChange",value:function(e){return e!=this.state.selectedIndex&&(this.setState({showSpiner:!1,selectedIndex:e}),void(this.isQRCode(e)?(this.setState({stopPollingQrcode:!1}),this.state.qrCodeTaskInfo?this.startPoll(this.state.qrCodeTaskInfo):this.refs["ImportForm-"+e].createBankQrcodeTask()):this.setState({stopPollingQrcode:!0})))}},{key:"onSubmitTaskDone",value:function(e){this.props.hideVCodeModal(),window.storage.setItem(J,JSON.stringify(e)),"qrcode"!=e.loginType&&this.setState({taskInfo:e}),this.startPoll(e)}},{key:"startPoll",value:function(e){var t=this;(0,y.default)({task:e,isLogin:!1,callbacks:{waitCode:this.initVCode.bind(this),doneLogin:this.doneLogin.bind(this),doneSucc:this.onSucc.bind(this),doneFail:this.onFail.bind(this),doneTimeout:this.onFail.bind(this),doing:this.doing.bind(this),pendingTimeout:this.onPendingTimeout.bind(this),error:this.onError.bind(this),setqrCodeTaskInfo:this.setqrCodeTaskInfo.bind(this),doneScan:function(){t.setState({isScanned:!0,showSpiner:!0})}}})}},{key:"getVcodeAgain",value:function(e,t){var a=this;(0,k.getNewVCodeAgain)(e,t).then(function(e){e.body&&200==e.body.value&&a.startPoll(t)}).catch(function(e){a.handleError(e),console.log(e)})}},{key:"initVCode",value:function(e,t){var a=this;return!!(this.unmounted||"qrcode"==e.loginType&&this.state.stopPollingQrcode)||"qrcode"!=e.loginType&&!this.state.taskInfo||("qrcode"!=t.input.type&&this.setState({showSpiner:!1}),"qrcode"==t.input.type&&"qrcode"==e.loginType?(this.setState({showSpiner:!1}),this.setState({qrcodeValue:t.input.value})):(console.log("11111======",t.description),this.props.showVCodeModal({title:"update"==t.input.type?"更新信息":"验证码",desc:t.description,waitSeconds:0,type:t.input.type,taskType:"bank",imgSrc:t.input.value,refresh_enabled:"1"==t.refresh_enabled,onConfirm:function(n){a.setState({desc:""}),(0,k.submitVCode)(n,e,t.input.type).catch(function(e){console.log(e)}).then(function(){a.startPoll(e)})},cancelTask:function(){(0,k.cancelTask)(e).then(function(e){})},onCancel:function(){a.storeLoginInfo(e,!0),a.setState({taskInfo:null})}},t)),this.updateState(e,t),!("qrcode"==e.loginType&&"qrcode"==t.input.type&&this.state.qrCodeTaskInfo||"qrcode"==t.input.type&&this.state.taskInfo))}},{key:"doneLogin",value:function(e,t){("qrcode"==e.loginType&&"DONE"==t.phase&&"DONE_SUCC"==t.phase_status||"DONE_FAIL"==t.phase_status)&&storage.removeItem(e.bankId+"-"+e.loginTarget+"-bankQRCodeTask"),"qrcode"==e.loginType&&"DONE_TIMEOUT"==t.phase_status||(this.updateState(e,t),this.setState({isLoginDone:!0}))}},{key:"removeTaskStore",value:function(){window.storage.removeItem(J)}},{key:"doing",value:function(e,t){return!!(this.unmounted||this.state.stopPollingQrcode&&"qrcode"==e.loginType)||void this.updateState(e,t)}},{key:"updateState",value:function(e,t){return this.setState({phase:t.phase,desc:t.description,isLoginDone:t.phase!==f.PHASE.LOGIN}),!!this.state.hasQuit}},{key:"storeLoginInfo",value:function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];"qrcode"==e.loginType&&storage.removeItem(e.bankId+"-"+e.loginTarget+"-bankQRCodeTask"),this.removeTaskStore();var a=this.props.params.cardType||d.qsParams.cardType;void 0==e.bankId&&(e.bankId=0),void 0==e.loginModel&&(e.loginModel=0),void 0==e.loginType&&(e.loginType=0),h.default.set(e.taskType,e.bankId,a,e.loginType,{loginParam:e.loginParam,loginFail:t})}},{key:"handleError",value:function(e){this.setState({taskInfo:null}),this.props.hideVCodeModal();var t=e&&e.body&&e.body.detail||"网络异常，请稍后再试!\n"+e;p.default.alert(t)}},{key:"onSucc",value:function(e,t){return this.storeLoginInfo(e),!!(this.unmounted||this.state.stopPollingQrcode&&"qrcode"==e.loginType)||(t.description=Z,this.updateState(e,t),void this.setState({taskStatus:j.TASK_STATUS.SUCC}))}},{key:"onFail",value:function(e,t){return("qrcode"==e.loginType&&"DONE"==t.phase&&"DONE_SUCC"==t.phase_status||"DONE_FAIL"==t.phase_status||"任务不存在"==t.description)&&storage.removeItem(e.bankId+"-"+e.loginTarget+"-bankQRCodeTask"),this.storeLoginInfo(e,!0),!!(this.unmounted||this.state.stopPollingQrcode&&"qrcode"==e.loginType)||("qrcode"==e.loginType&&"DONE_TIMEOUT"==t.phase_status?void this.setState({desc:t.description,qrcodeValue:null,qrcodeTimeout:!0,qrCodeTaskInfo:null,isScanned:!1}):("qrcode"==e.loginType&&"BALO-23001-10"==t.error_code&&this.setState({qrcodeValue:null,desc:t.description,qrcodeTimeout:!0,qrCodeTaskInfo:null,getQrcodeError:!0,isScanned:!1}),this.props.hideVCodeModal(),t.phase!=f.PHASE.LOGIN&&this.setState({taskStatus:j.TASK_STATUS.FAIL,desc:t.description}),this.setState({taskInfo:null}),void("qrcode"==e.loginType?this.setState({qrCodeTaskInfo:null,isScanned:!1}):this.setState({taskInfo:null}))))}},{key:"onPendingTimeout",value:function(e){return this.storeLoginInfo(e),!!(this.unmounted||this.state.stopPollingQrcode&&"qrcode"==e.loginType)||(this.props.hideVCodeModal(),this.setState({taskStatus:j.TASK_STATUS.FAIL,desc:X,taskInfo:null}),void("qrcode"==e.loginType?this.setState({qrCodeTaskInfo:null,isScanned:!1}):this.setState({taskInfo:null})))}},{key:"onError",value:function(e,t){return!!(this.unmounted||this.state.stopPollingQrcode&&"qrcode"==e.loginType)||(this.props.hideVCodeModal(),console.log(t),this.storeLoginInfo(e,!0),this.setState({taskStatus:j.TASK_STATUS.FAIL,desc:"服务异常,请稍后再试",taskInfo:null}),void("qrcode"==e.loginType?this.setState({qrCodeTaskInfo:null,isScanned:!1}):this.setState({taskInfo:null})))}},{key:"handleBack",value:function(){(this.state.isLoginDone||this.state.isFail)&&(d.qsParams.backUrl||d.qsParams.back_url)?(0,B.default)({taskType:"bank"}):(this.unmounted=!0,this.setState({hasQuit:!0}),b.default.call(this))}}]);var a=t;return t=(0,W.observer)(t)||t}(u.default.Component);t.default=ee,e.exports=t.default}).call(this)}finally{}}});