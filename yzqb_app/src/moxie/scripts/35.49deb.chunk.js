webpackJsonp([35],{15:function(e,t,o){try{(function(){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function r(e,t){var o={};for(var a in e)t.indexOf(a)>=0||Object.prototype.hasOwnProperty.call(e,a)&&(o[a]=e[a]);return o}function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,o,a){return o&&e(t.prototype,o),a&&e(t,a),t}}(),l=function(e,t,o){for(var a=!0;a;){var r=e,n=t,s=o;a=!1,null===r&&(r=Function.prototype);var i=Object.getOwnPropertyDescriptor(r,n);if(void 0!==i){if("value"in i)return i.value;var l=i.get;if(void 0===l)return;return l.call(s)}var d=Object.getPrototypeOf(r);if(null===d)return;e=d,t=n,o=s,a=!0,i=d=void 0}},d=o(2),u=a(d),p=o(16),c=o(10),f=(a(c),o(1)),h=function(e){function t(e,o){n(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,o),this.state={}}return s(t,e),i(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.showTips,o=e.showOrHideSpinner,a=e.size,n=e.color,s=e.boxSize,i=(r(e,["showTips","showOrHideSpinner","size","color","boxSize"]),{display:o,width:"100%",maxWidth:f.qsParams.maxWidth?f.qsParams.maxWidth:"800px",height:f.qsParams.height?f.qsParams.height+"px":"100%",position:"fixed",right:0,bottom:0,margin:"0 auto",left:0,top:0,zIndex:996,background:"rgba(0,0,0,.4)"});return u.default.createElement("div",{style:i},u.default.createElement("div",{className:"SpinerBox",style:{overflow:"hidden",background:"rgba(22,22,22,0.8)",position:"absolute",top:"40%",left:"50%",width:""+s,height:""+s,borderRadius:"10px"}},u.default.createElement("div",{className:"newSpiner",style:{top:t?s/6+"px":(s-a)/2+"px"}},u.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",width:a,height:a,fill:n},u.default.createElement("path",{opacity:".25",d:"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4"}),u.default.createElement("path",{d:"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z"}))),u.default.createElement("div",{style:{color:"#fff",textAlign:"center",width:"100%",fontSize:"13px",position:"absolute",top:""+2*s/3}},t)))}}]),t}(u.default.Component);t.default=h,h.contextTypes={history:function(){return p.PropTypes.history}},h.defaultProps={boxSize:120,size:48,showTips:"正在加载",color:"#fff"},e.exports=t.default}).call(this)}finally{}},19:function(e,t,o){try{(function(){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=e.task,o=e.callbacks;o=l({waitCode:d.noop,doneSucc:d.noop,doneFail:d.noop,doneTimeout:d.noop,doneLogin:d.noop,pendingTimeout:d.noop,doing:d.noop,error:d.noop,spiner:d.noop,showProgress:d.noop,importSucc:d.noop,onError:d.noop,errorCatch:d.noop,refreshImgCode:d.noop,setqrCodeTaskInfo:d.noop,doneScan:d.noop,zxBankSpiner:d.noop,showQrcodeInCrawlStatus:d.noop,hideQrCode:d.noop},o);var p,c=r(t),f=d.request.get(c+("?d="+Date.now())).set(l({},h.default.addDefaultHeaders())).set("Accept","application/json").set("Cache-Control","no-store");return p="carrier"==t.taskType?(0,d.guardTimeoutLongtime)(f):(0,d.guardTimeout)(f),p.then(function(e){var r=!1;if(o.setqrCodeTaskInfo&&"qrcode"==t.loginType&&o.setqrCodeTaskInfo(t),o.showProgress&&o.showProgress(e.body.description),"LOGIN"!=e.body.phase&&(o.doneLogin&&(r=o.doneLogin(t,e.body)),"alipay"==t.taskType&&"WAIT_CODE"!=e.body.phase_status&&o.hideQrCode&&o.hideQrCode(),n(t),(u.qsParams.quitOnLoginDone||u.qsParams.canLeave)&&"zhengxin"!=t.taskType))return r=!0,!1;switch("LOGIN"==e.body.phase&&"WAIT_CODE"!=e.body.phase_status&&o.doneScan&&o.doneScan(),e.body.phase_status){case v.WAIT_CODE:o.spiner&&o.spiner(),o.zxBankSpiner&&o.zxBankSpiner(),o.waitCode&&(r=o.waitCode(t,e.body));break;case v.CONTINUE:o.spiner&&o.spiner(),o.zxBankSpiner&&o.zxBankSpiner(),o.waitCode&&o.waitCode(t,e.body);break;case v.DONE_SUCC:e.body.finished===!0?(o.zxBankSpiner&&o.zxBankSpiner(),storage.setItem(t.taskType+"ImportStatus","succ"),setTimeout(function(){o.spiner&&o.spiner(),o.showProgress&&o.showProgress(""),b.default.refreshStatus("1",e.body.description)},3e3),o.importSucc&&o.importSucc(e.body),o.doneSucc&&o.doneSucc(t,e.body),r=!0,s(t)):o.doing&&(r=o.doing(t,e.body));break;case v.DONE_FAIL:o.hideQrCode&&o.hideQrCode(),storage.setItem(t.taskType+"ImportStatus","fail"),"LOGIN"===e.body.phase?("BALO-23001-10"==e.body.error_code&&o.doneTimeout&&o.doneTimeout(t,e.body),o.refreshImgCode(),b.default.refreshStatus("-4",e.body.description)):b.default.refreshStatus("0",e.body.description),o.zxBankSpiner&&o.zxBankSpiner(),setTimeout(function(){o.spiner&&o.spiner(),o.showProgress&&o.showProgress("")},3e3),o.doneFail&&o.doneFail(t,e.body),r=!0,i(t,e);break;case v.DONE_TIMEOUT:o.hideQrCode&&o.hideQrCode(),storage.setItem(t.taskType+"ImportStatus","fail"),"LOGIN"===e.body.phase?b.default.refreshStatus("-4",e.body.description,t.loginType,e.body.phase):b.default.refreshStatus("0",e.body.description,t.loginType,e.body.phase),o.doneTimeout&&o.doneTimeout(t,e.body),r=!0,i(t,e);break;case v.DOING:b.default.refreshStatus("2",e.body.description,t.loginType,e.body.phase),o.doing&&(r=o.doing(t,e.body));break;default:b.default.refreshStatus("-3","异常错误"),o.doneFail&&o.doneFail(t,e.body),r=!0,i(t,e)}"LOGIN"!=e.body.phase,r||setTimeout(function(){a({task:t,callbacks:o})},g)}).catch(function(e){var a=e&&e.body&&e.body.detail||e;b.default.alert("服务异常，请稍候再试！"+a),o.zxBankSpiner&&o.zxBankSpiner(),o.spiner&&o.spiner(),o.onError&&o.onError(t,e),o.error&&o.error(t,e),o.errorCatch&&o.errorCatch(e)})}function r(e){var t="";return t="bank"==e.taskType?c.default.checkImportState.replace("{taskid}",e.taskId):"carrier"==e.taskType?c.default.checkCarrierImportStatev2.replace("{taskid}",e.taskId):"chsi"==e.taskType?c.default.checkChsiImportState.replace("{taskid}",e.taskId):"fund"==e.taskType?c.default.checkFundImportState.replace("{taskid}",e.taskId):"email"==e.taskType||"qq"==e.taskType?c.default.checkEmailImportState.replace("{taskid}",e.taskId):"tax"==e.taskType?c.default.taxStatus.replace("{task_id}",e.taskId)+("?d="+Date.now()):"security"==e.taskType?c.default.checkSecurityImportState.replace("{taskid}",e.taskId)+("?d="+Date.now()):"alipay"==e.taskType||"wechat"==e.taskType?c.default.commonImportStateUrlv2.replace("{taskid}",e.taskId):"sametrade"==e.taskType?c.default.checkSametradeTaskStatus.replace("{task_id}",e.taskId):c.default.commonImportStateUrl.replace("{taskid}",e.taskId)}function n(e){b.default.mxHideWebView(),b.default.mxCanLeave(!0),b.default.loginDone=1,(u.qsParams.canLeave||u.qsParams.quitOnLoginDone)&&"zhengxin"!=e.taskType&&(console.log("finishImport"),b.default.finishImport(e.taskId,"2","登录认证成功","SUCC"),(0,m.default)({taskType:e.taskType}))}function s(e){b.default.finishImport(e.taskId,"1","认证成功","SUCC"),(0,m.default)({taskType:e.taskType})}function i(e,t){console.log("handleDoneFail"),"LOGIN"===t.body.phase?"zhengxin"!=e.taskType&&("qrcode"==e.loginType&&"DONE_TIMEOUT"==t.body.phase_status||b.default.alert(t.body.description)):(b.default.finishImport(e.taskId,"0",t.description,"FAIL"),u.qsParams.quitOnFail&&(0,m.default)({taskType:e.taskType}))}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var a in o)Object.prototype.hasOwnProperty.call(o,a)&&(e[a]=o[a])}return e},d=o(1),u=o(1),p=o(25),c=e(p),f=o(12),h=e(f),y=o(29),m=e(y),k=o(4),b=e(k),g=2500,v={DOING:"DOING",WAIT_CODE:"WAIT_CODE",DONE_SUCC:"DONE_SUCC",DONE_FAIL:"DONE_FAIL",DONE_TIMEOUT:"DONE_TIMEOUT"};t.STATE=v,t.default=a}).call(this)}finally{}},802:function(e,t,o){try{(function(){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var n=function(){function e(e,t){for(var o=0;o<t.length;o++){var a=t[o];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,o,a){return o&&e(t.prototype,o),a&&e(t,a),t}}(),s=function(e,t,o){for(var a=!0;a;){var r=e,n=t,s=o;a=!1,null===r&&(r=Function.prototype);var i=Object.getOwnPropertyDescriptor(r,n);if(void 0!==i){if("value"in i)return i.value;var l=i.get;if(void 0===l)return;return l.call(s)}var d=Object.getPrototypeOf(r);if(null===d)return;e=d,t=n,o=s,a=!0,i=d=void 0}},i=o(2),l=t(i),d=o(10),u=t(d),p=o(16),c=o(1),f=o(6),h=t(f),y=o(11),m=t(y),k=o(15),b=t(k),g=o(73),v=t(g),T=o(19),S=t(T),w=o(7),C=t(w),O=o(8),I=o(9),E=t(I),P="#58B5EB",x=function(e){function t(e,o){a(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,o),this.state={showTip:"none",tips:null,cardNum:null,showspinner:"none",pollTips:null,task:null,importFinished:!1,resultDescription:null,showAttention:"none",validated:!0,registerConfig:null}}return r(t,e),n(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props.params.bankId,o=this.props.params.cardType;this.setState({cardType:o}),(0,O.fetchLoginConfig)({taskType:"bankRegister",cardType:o,bankMark:t}).then(function(t){e.setState({registerConfig:t.body})}).catch(function(e){console.log(e)})}},{key:"componentDidMount",value:function(){PG.refreshTitle("网银注册")}},{key:"render",value:function(){var e=this;return this.state.registerConfig?l.default.createElement("div",{className:"bankRegister mx-view",style:{background:"#f6f8fc",padding:"0 10px"}},"NO"==c.qsParams.showTitleBar||0==c.qsParams.showTitleBar||PG.Device.SDK?null:l.default.createElement("div",{style:{height:"NO"==c.qsParams.showTitleBar||PG.Device.SDK?0:44}},l.default.createElement(h.default,{title:"网银注册",left:l.default.createElement(C.default,{onTap:function(){E.default.call(e)}},l.default.createElement("i",{className:"ion-chevron-left"}))})),l.default.createElement("div",null,this.state.importFinished?this.resultPage():l.default.createElement("div",null,l.default.createElement(b.default,{showOrHideSpinner:this.state.showspinner,showTips:this.state.pollTips}),this.renderInputItem(),l.default.createElement("div",{style:{display:this.state.showTip},className:"zx_tip"},this.state.tips),l.default.createElement("div",{style:{padding:" 20px 15px"},className:"reportBtn"},l.default.createElement(u.default,{onTap:this.submitTask.bind(this)},l.default.createElement("button",{style:{backgroundColor:c.qsParams.themeColor&&"undefined"!=c.qsParams.themeColor?c.qsParams.themeColor:P,width:"100%"}},"提交")))))):l.default.createElement("div",{className:"centered"},l.default.createElement(m.default,{size:"44",color:"#999"}))}},{key:"initVCode",value:function(e,t){var o=this;return this.setState({showspinner:"none"}),this.props.showVCodeModal({title:"验证码",desc:t.description,waitSeconds:0,type:t.input.type,imgSrc:"img"==t.input.type?t.input.value:"",onConfirm:function(t){o.submitVCode(t,e),o.setState({showspinner:"block"})},onCancel:function(){}}),!0}},{key:"renderInputItem",value:function(){var e=this.state.registerConfig.fields;return l.default.createElement("div",{style:{paddingTop:"10px"}},e.map(function(e){return l.default.createElement(v.default,{ref:e.field_name,type:"loginpwd"==e.field_name||"cashpwd"==e.field_name?"password":"text",placeholder:e.field_desc+"/"+e.field_tips})}))}},{key:"submitTask",value:function(){for(var e=this,t=this.state.registerConfig.fields,o=0;o<t.length;o++)if(!new RegExp(t[o].field_regex).test(this.refs[t[o].field_name].getValue()))return void alert(t[o].field_desc+"格式不正确！");for(var a={},o=0;o<t.length;o++)a[t[o].field_name]=this.refs[t[o].field_name].getValue();this.setState({showspinner:"block",pollTips:""});var r=this.props.params.bankId,n=this.props.params.cardType;(0,O.submitTaskHelper)({taskType:"bankRegister",registerParams:a,taskSubType:r,cardType:n}).then(function(t){PG.refreshStatus("2","创建任务成功"),PG.mxSaveTaskId(t.body.task_id);var o={taskId:t.body.task_id,taskType:"bank"};e.setState({task:o,showTip:"none",tips:""}),e.startPoll()}).catch(function(t){e.errorCatch.bind(e,t)()})}},{key:"startPoll",value:function(){this.props.hideVCodeModal(),(0,S.default)({task:this.state.task,callbacks:{bankRegisterSpiner:this.bankRegisterSpiner.bind(this),showProgress:this.showProgress.bind(this),errorCatch:this.errorCatch.bind(this),importSucc:this.importSucc.bind(this),waitCode:this.initVCode.bind(this),doneFail:this.doneFail.bind(this)}})}},{key:"submitVCode",value:function(e,t){var o=this;(0,O.submitVCode)(e,t).catch(function(e){console.log(e)}).then(function(e){o.startPoll()})}},{key:"bankRegisterSpiner",value:function(e){this.setState({showspinner:"none",pollTips:e})}},{key:"showProgress",value:function(e){this.setState({pollTips:e})}},{key:"errorCatch",value:function(e){this.setState({showspinner:"none",pollTips:""});var t=e&&e.body&&e.body.detail||{};t.errors&&t.errors[0]&&(10220011===t.errors[0].code||10220012===t.errors[0].code)?(PG.refreshStatus("-2",t.errors[0].message),this.setState({tips:t.errors[0].message,showTips:"block"})):(PG.refreshStatus("-3","服务异常，创建任务失败"),this.handleError(e))}},{key:"handleError",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?"任务失败!":arguments[1];try{t=e&&e.body&&e.body.detail||t}catch(e){}"任务失败!"==t?PG.alert(t+"\n"+e):PG.alert(t),this.setState({isStart:!1})}},{key:"doneFail",value:function(e,t){this.setState({showspinner:"none",pollTips:""}),PG.alert(t.description)}},{key:"resultPage",value:function(){var e="#c11000",t={color:c.qsParams.themeColor?"#"+c.qsParams.themeColor:P,textAlign:"center",width:"250px",marginTop:"10px",lineHeight:1.5};return l.default.createElement("div",null,l.default.createElement("div",{className:"finish-status succ finish-status-carrier",style:{borderBottom:"1px solid #e5e5e5",position:"static"}},l.default.createElement("svg",{width:"48",height:"48",viewBox:"0 0 48 48",style:{display:"block",margin:"15px auto 0"}},l.default.createElement("g",{class:"transform-group"},l.default.createElement("g",{transform:"scale(0.046875, 0.046875)"},l.default.createElement("path",{d:"M511.996387 9.862132c-277.328216 0-502.134255 224.813265-502.134255 502.137868 0 277.328216 224.80604 502.137868 502.134255 502.137868 277.320991 0 502.137868-224.809652 502.137868-502.137868C1014.137868 234.675397 789.320991 9.862132 511.996387 9.862132L511.996387 9.862132zM824.889692 388.748635l-351.388132 338.834686c-4.670966 4.663741-9.952445 8.337656-15.587949 11.028971-22.065166 15.761349-52.915939 13.75641-72.730516-6.061779l-150.897848-150.897848c-22.065166-22.065166-22.065166-57.832555 0-79.883271 22.054329-22.065166 57.821717-22.065166 79.886884 0l113.291695 113.28447 317.531758-306.192112c22.061554-22.061554 57.832555-22.061554 79.883271 0C846.954858 330.919692 846.954858 366.687081 824.889692 388.748635L824.889692 388.748635zM824.889692 388.748635",fill:e})))),l.default.createElement("p",{style:t},this.state.resultDescription)))}},{key:"importSucc",value:function(e){this.setState({importFinished:!0,resultDescription:e.description})}}]),t}(l.default.Component);x.contextTypes={history:p.PropTypes.history},e.exports=x}).call(this)}finally{}}});