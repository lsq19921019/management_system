webpackJsonp([6,39],{15:function(e,t,a){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),i=function(e,t,a){for(var n=!0;n;){var o=e,r=t,s=a;n=!1,null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,r);if(void 0!==l){if("value"in l)return l.value;var i=l.get;if(void 0===i)return;return i.call(s)}var u=Object.getPrototypeOf(o);if(null===u)return;e=u,t=r,a=s,n=!0,l=u=void 0}},u=a(2),c=n(u),d=a(16),f=a(10),p=(n(f),a(1)),m=function(e){function t(e,a){r(this,t),i(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,a),this.state={}}return s(t,e),l(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.showTips,a=e.showOrHideSpinner,n=e.size,r=e.color,s=e.boxSize,l=(o(e,["showTips","showOrHideSpinner","size","color","boxSize"]),{display:a,width:"100%",maxWidth:p.qsParams.maxWidth?p.qsParams.maxWidth:"800px",height:p.qsParams.height?p.qsParams.height+"px":"100%",position:"fixed",right:0,bottom:0,margin:"0 auto",left:0,top:0,zIndex:996,background:"rgba(0,0,0,.4)"});return c.default.createElement("div",{style:l},c.default.createElement("div",{className:"SpinerBox",style:{overflow:"hidden",background:"rgba(22,22,22,0.8)",position:"absolute",top:"40%",left:"50%",width:""+s,height:""+s,borderRadius:"10px"}},c.default.createElement("div",{className:"newSpiner",style:{top:t?s/6+"px":(s-n)/2+"px"}},c.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",width:n,height:n,fill:r},c.default.createElement("path",{opacity:".25",d:"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4"}),c.default.createElement("path",{d:"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z"}))),c.default.createElement("div",{style:{color:"#fff",textAlign:"center",width:"100%",fontSize:"13px",position:"absolute",top:""+2*s/3}},t)))}}]),t}(c.default.Component);t.default=m,m.contextTypes={history:function(){return d.PropTypes.history}},m.defaultProps={boxSize:120,size:48,showTips:"正在加载",color:"#fff"},e.exports=t.default}).call(this)}finally{}},17:function(e,t,a){try{(function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e={DEFAULT:"DEFAULT",SUCC:"SUCC",FAIL:"FAIL"};t.TASK_STATUS=e}).call(this)}finally{}},19:function(e,t,a){try{(function(){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=e.task,a=e.callbacks;a=i({waitCode:u.noop,doneSucc:u.noop,doneFail:u.noop,doneTimeout:u.noop,doneLogin:u.noop,pendingTimeout:u.noop,doing:u.noop,error:u.noop,spiner:u.noop,showProgress:u.noop,importSucc:u.noop,onError:u.noop,errorCatch:u.noop,refreshImgCode:u.noop,setqrCodeTaskInfo:u.noop,doneScan:u.noop,zxBankSpiner:u.noop,showQrcodeInCrawlStatus:u.noop,hideQrCode:u.noop},a);var d,f=o(t),p=u.request.get(f+("?d="+Date.now())).set(i({},m.default.addDefaultHeaders())).set("Accept","application/json").set("Cache-Control","no-store");return d="carrier"==t.taskType?(0,u.guardTimeoutLongtime)(p):(0,u.guardTimeout)(p),d.then(function(e){var o=!1;if(a.setqrCodeTaskInfo&&"qrcode"==t.loginType&&a.setqrCodeTaskInfo(t),a.showProgress&&a.showProgress(e.body.description),"LOGIN"!=e.body.phase&&(a.doneLogin&&(o=a.doneLogin(t,e.body)),"alipay"==t.taskType&&"WAIT_CODE"!=e.body.phase_status&&a.hideQrCode&&a.hideQrCode(),r(t),(c.qsParams.quitOnLoginDone||c.qsParams.canLeave)&&"zhengxin"!=t.taskType))return o=!0,!1;switch("LOGIN"==e.body.phase&&"WAIT_CODE"!=e.body.phase_status&&a.doneScan&&a.doneScan(),e.body.phase_status){case T.WAIT_CODE:a.spiner&&a.spiner(),a.zxBankSpiner&&a.zxBankSpiner(),a.waitCode&&(o=a.waitCode(t,e.body));break;case T.CONTINUE:a.spiner&&a.spiner(),a.zxBankSpiner&&a.zxBankSpiner(),a.waitCode&&a.waitCode(t,e.body);break;case T.DONE_SUCC:e.body.finished===!0?(a.zxBankSpiner&&a.zxBankSpiner(),storage.setItem(t.taskType+"ImportStatus","succ"),setTimeout(function(){a.spiner&&a.spiner(),a.showProgress&&a.showProgress(""),k.default.refreshStatus("1",e.body.description)},3e3),a.importSucc&&a.importSucc(e.body),a.doneSucc&&a.doneSucc(t,e.body),o=!0,s(t)):a.doing&&(o=a.doing(t,e.body));break;case T.DONE_FAIL:a.hideQrCode&&a.hideQrCode(),storage.setItem(t.taskType+"ImportStatus","fail"),"LOGIN"===e.body.phase?("BALO-23001-10"==e.body.error_code&&a.doneTimeout&&a.doneTimeout(t,e.body),a.refreshImgCode(),k.default.refreshStatus("-4",e.body.description)):k.default.refreshStatus("0",e.body.description),a.zxBankSpiner&&a.zxBankSpiner(),setTimeout(function(){a.spiner&&a.spiner(),a.showProgress&&a.showProgress("")},3e3),a.doneFail&&a.doneFail(t,e.body),o=!0,l(t,e);break;case T.DONE_TIMEOUT:a.hideQrCode&&a.hideQrCode(),storage.setItem(t.taskType+"ImportStatus","fail"),"LOGIN"===e.body.phase?k.default.refreshStatus("-4",e.body.description,t.loginType,e.body.phase):k.default.refreshStatus("0",e.body.description,t.loginType,e.body.phase),a.doneTimeout&&a.doneTimeout(t,e.body),o=!0,l(t,e);break;case T.DOING:k.default.refreshStatus("2",e.body.description,t.loginType,e.body.phase),a.doing&&(o=a.doing(t,e.body));break;default:k.default.refreshStatus("-3","异常错误"),a.doneFail&&a.doneFail(t,e.body),o=!0,l(t,e)}"LOGIN"!=e.body.phase,o||setTimeout(function(){n({task:t,callbacks:a})},v)}).catch(function(e){var n=e&&e.body&&e.body.detail||e;k.default.alert("服务异常，请稍候再试！"+n),a.zxBankSpiner&&a.zxBankSpiner(),a.spiner&&a.spiner(),a.onError&&a.onError(t,e),a.error&&a.error(t,e),a.errorCatch&&a.errorCatch(e)})}function o(e){var t="";return t="bank"==e.taskType?f.default.checkImportState.replace("{taskid}",e.taskId):"carrier"==e.taskType?f.default.checkCarrierImportStatev2.replace("{taskid}",e.taskId):"chsi"==e.taskType?f.default.checkChsiImportState.replace("{taskid}",e.taskId):"fund"==e.taskType?f.default.checkFundImportState.replace("{taskid}",e.taskId):"email"==e.taskType||"qq"==e.taskType?f.default.checkEmailImportState.replace("{taskid}",e.taskId):"tax"==e.taskType?f.default.taxStatus.replace("{task_id}",e.taskId)+("?d="+Date.now()):"security"==e.taskType?f.default.checkSecurityImportState.replace("{taskid}",e.taskId)+("?d="+Date.now()):"alipay"==e.taskType||"wechat"==e.taskType?f.default.commonImportStateUrlv2.replace("{taskid}",e.taskId):"sametrade"==e.taskType?f.default.checkSametradeTaskStatus.replace("{task_id}",e.taskId):f.default.commonImportStateUrl.replace("{taskid}",e.taskId)}function r(e){k.default.mxHideWebView(),k.default.mxCanLeave(!0),k.default.loginDone=1,(c.qsParams.canLeave||c.qsParams.quitOnLoginDone)&&"zhengxin"!=e.taskType&&(console.log("finishImport"),k.default.finishImport(e.taskId,"2","登录认证成功","SUCC"),(0,y.default)({taskType:e.taskType}))}function s(e){k.default.finishImport(e.taskId,"1","认证成功","SUCC"),(0,y.default)({taskType:e.taskType})}function l(e,t){console.log("handleDoneFail"),"LOGIN"===t.body.phase?"zhengxin"!=e.taskType&&("qrcode"==e.loginType&&"DONE_TIMEOUT"==t.body.phase_status||k.default.alert(t.body.description)):(k.default.finishImport(e.taskId,"0",t.description,"FAIL"),c.qsParams.quitOnFail&&(0,y.default)({taskType:e.taskType}))}Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},u=a(1),c=a(1),d=a(25),f=e(d),p=a(12),m=e(p),h=a(29),y=e(h),g=a(4),k=e(g),v=2500,T={DOING:"DOING",WAIT_CODE:"WAIT_CODE",DONE_SUCC:"DONE_SUCC",DONE_FAIL:"DONE_FAIL",DONE_TIMEOUT:"DONE_TIMEOUT"};t.STATE=T,t.default=n}).call(this)}finally{}},21:function(e,t,a){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=function(e,t,a){for(var n=!0;n;){var o=e,r=t,s=a;n=!1,null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,r);if(void 0!==l){if("value"in l)return l.value;var i=l.get;if(void 0===i)return;return i.call(s)}var u=Object.getPrototypeOf(o);if(null===u)return;e=u,t=r,a=s,n=!0,l=u=void 0}},i=a(2),u=n(i),c=function(e){function t(e,a){o(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,a)}return r(t,e),s(t,null,[{key:"propTypes",value:{desc:i.PropTypes.string.isRequired},enumerable:!0}]),s(t,[{key:"render",value:function(){var e=u.default.createElement("img",{style:{width:"350px"},src:a(45)});return u.default.createElement("div",{className:"waiting-view"},u.default.createElement("h3",{style:{width:"80%",textAlign:"center",fontSize:"16px",color:"#70BEEB",height:"50px",lineHeight:"50px",borderBottom:"1px solid #efeff4"}},"获取结果中..."),u.default.createElement("h4",{style:{height:"20px",fontSize:"14px",color:"#666666"}},this.props.desc),u.default.createElement("div",{className:"waiting-gif"},e))}}]),t}(u.default.Component);t.default=c,e.exports=t.default}).call(this)}finally{}},22:function(e,t,a){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=function(e,t,a){for(var n=!0;n;){var o=e,r=t,s=a;n=!1,null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,r);if(void 0!==l){if("value"in l)return l.value;var i=l.get;if(void 0===i)return;return i.call(s)}var u=Object.getPrototypeOf(o);if(null===u)return;e=u,t=r,a=s,n=!0,l=u=void 0}},i=a(2),u=n(i),c=a(1),d=a(23),f=a(5),p=n(f),m=(a(17),function(e){function t(e,a){o(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,a),this.state={}}return r(t,e),s(t,null,[{key:"propTypes",value:{succ:i.PropTypes.bool.isRequired,taskInfo:i.PropTypes.any.isRequired,canQuitAuth:i.PropTypes.bool},enumerable:!0}]),s(t,[{key:"render",value:function(){var e=this,t={color:void 0!=c.qsParams.themeColor?"#"+c.qsParams.themeColor:d.DEFAULT_THEMECOLOR,fontSize:"12px"},a=void 0!=c.qsParams.themeColor?"#"+c.qsParams.themeColor:d.DEFAULT_THEMECOLOR,n=null;return n=this.props.succ?u.default.createElement("div",{className:"finish-status succ"},u.default.createElement("svg",{width:"48",height:"48",viewBox:"0 0 48 48"},u.default.createElement("g",{className:"transform-group"},u.default.createElement("g",{transform:"scale(0.046875, 0.046875)"},u.default.createElement("path",{d:"M511.996387 9.862132c-277.328216 0-502.134255 224.813265-502.134255 502.137868 0 277.328216 224.80604 502.137868 502.134255 502.137868 277.320991 0 502.137868-224.809652 502.137868-502.137868C1014.137868 234.675397 789.320991 9.862132 511.996387 9.862132L511.996387 9.862132zM824.889692 388.748635l-351.388132 338.834686c-4.670966 4.663741-9.952445 8.337656-15.587949 11.028971-22.065166 15.761349-52.915939 13.75641-72.730516-6.061779l-150.897848-150.897848c-22.065166-22.065166-22.065166-57.832555 0-79.883271 22.054329-22.065166 57.821717-22.065166 79.886884 0l113.291695 113.28447 317.531758-306.192112c22.061554-22.061554 57.832555-22.061554 79.883271 0C846.954858 330.919692 846.954858 366.687081 824.889692 388.748635L824.889692 388.748635zM824.889692 388.748635",fill:a})))),u.default.createElement("p",{style:t},"验证成功"),c.qsParams.token?u.default.createElement(p.default,{types:"full",style:"width:50%;height:44px;",onTap:function(){e.onSuccDetailButtonClick()}},"详情查询"):null):u.default.createElement("div",{className:"finish-status fail"},u.default.createElement("i",{className:"import-fail-img"}),u.default.createElement("p",{className:"fail-desc",style:{marginBottom:"20px"}},this.props.desc),"YES"!=c.qsParams.notRetryOnFail&&1!=c.qsParams.notRetryOnFail?u.default.createElement(p.default,{types:"full",style:"width:50%;height:44px;",onTap:function(){e.retryButtonClick()}},"点击重试"):null),u.default.createElement("div",{className:"waiting-view"},u.default.createElement("div",{className:"waiting-gif"},n))}},{key:"retryButtonClick",value:function(){window.location.reload()}},{key:"retryButtonClick",value:function(){window.location.reload()}},{key:"onSuccDetailButtonClick",value:function(){if(void 0==c.qsParams.token)return void PG.alert("缺少token值");var e=this.props.taskInfo,t=(0,c.getENV)(),a="";a="test"==t?"http://192.168.0.11:8282":"pre"==t||"qa"==t?"https://qa.51datakey.com":"https://api.51datakey.com";var n="";switch(e.taskType){case"email":n=a+"/h5/resultV3/index.html#/emailResult?taskId="+e.taskId+"&token="+c.qsParams.token+"&mainTitle="+c.qsParams.mainTitle+"&icoUrl="+c.qsParams.icoUrl;break;case"bank":n=a+"/h5/resultV3/index.html#/bankResult/?taskId="+e.taskId+"&token="+c.qsParams.token+"&mainTitle="+c.qsParams.mainTitle+"&icoUrl="+c.qsParams.icoUrl;break;case"carrier":n=a+"/h5/resultV4/carrier/index.html?taskId="+e.account+"&token="+c.qsParams.token+"&mainTitle="+c.qsParams.mainTitle+"&icoUrl="+c.qsParams.icoUrl;break;case"shixin":n=a+"/h5/resultV4/shixin/index.html?taskId="+e.taskId+"&token="+c.qsParams.token+"&mainTitle="+c.qsParams.mainTitle+"&icoUrl="+c.qsParams.icoUrl;break;case"tax":n=a+"/h5/resultV4/tax/index.html?taskId="+e.taskId+"&token="+c.qsParams.token+"&mainTitle="+c.qsParams.mainTitle+"&icoUrl="+c.qsParams.icoUrl;break;case"zhixing":n=a+"/h5/resultV4/zhixing/index.html?taskId="+e.taskId+"&token="+c.qsParams.token+"&mainTitle="+c.qsParams.mainTitle+"&icoUrl="+c.qsParams.icoUrl;break;default:n=a+"/h5/resultV3/index.html#/"+e.taskType+"?taskId="+e.taskId+"&token="+c.qsParams.token+"&mainTitle="+c.qsParams.mainTitle+"&icoUrl="+c.qsParams.icoUrl}"test"==t?n+="&env=test":"pre"!=t&&"qa"!=t||(n+="&env="+t),window.location.href=n}}]),t}(u.default.Component));t.default=m,e.exports=t.default}).call(this)}finally{}},23:function(e,t,a){try{(function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e="#58B5EB";t.DEFAULT_THEMECOLOR=e}).call(this)}finally{}},24:function(e,t,a){try{(function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e={LOGIN:"LOGIN",RECEIVE:"RECEIVE",EXTRACT:"EXTRACT",STORE:"STORE",DONE:"DONE"};t.PHASE=e}).call(this)}finally{}},226:function(e,t,a){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(2),r=n(o),s=(a(1),a(8)),l=a(9),i=(n(l),a(4)),u=n(i),c=a(14),d=n(c),f=a(40),p=a(13),m=n(p),h=a(5),y=n(h),g=a(11),k=(n(g),a(18)),v=n(k),T=a(6),b=(n(T),a(7)),E=(n(b),a(268)),S=n(E),w=a(41),P=n(w),I=(a(166),/^[0-9a-z][_.0-9a-z-]{0,31}@([0-9a-z][0-9a-z-]{0,30}[0-9a-z]\.){1,4}[a-z]{2,4}$/i),O=r.default.createClass({displayName:"ImportForm",getInitialState:function(){return{phoneInfo:null,unsupport:!1,showUnsupport:!1,isStart:!1,defaultPhone:"",Type:"password",frontConf:this.props.frontConf}},componentDidMount:function(){var e=this,t=[];document.getElementsByClassName("emailSelect")[0]&&(t=document.getElementsByClassName("emailSelect")[0].getElementsByTagName("li"));for(var a=0;a<t.length;a++)t[a].onclick=function(){var e=this.getElementsByTagName("span")[0].innerHTML,t=this.getElementsByTagName("a")[0].innerHTML;document.getElementById("emailMobile").getElementsByTagName("input")[0].value=e+t,document.getElementsByClassName("emailSelect")[0]&&(document.getElementsByClassName("emailSelect")[0].style.display="none")};document.onclick=function(){document.getElementsByClassName("emailSelect")[0]&&(document.getElementsByClassName("emailSelect")[0].style.display="none")},document.getElementsByClassName("mx-view")[0].onclick=function(){document.getElementsByClassName("emailSelect")[0]&&(document.getElementsByClassName("emailSelect")[0].style.display="none")};var n=(0,f.getParams)("loginParams");n&&"undefined"!=n&&n.username&&n.password&&(this.timer=setInterval(function(){""!=e.refs.phone.getValue()&&""!=e.refs.password.getValue()&&(clearInterval(e.timer),e.handleImport())},100))},componentWillUnmount:function(){this.unmount=!0,clearInterval(this.timer)},render:function(){var e=this,t=(this.handleImport,this.state),a=t.unsupport,n=t.showUnsupport,o=t.isStart,s=(t.defaultPhone,(0,f.getParams)("loginParams")),l=s?s.password:null,i=d.default.get("email",0,0,0),u="";i&&i.loginParam&&(u=i.loginParam.phone);var c=n?r.default.createElement("div",{className:"carrier-unsupport"},r.default.createElement("i",null),r.default.createElement("p",null,a)):r.default.createElement("div",null,r.default.createElement("div",{className:"form common-form"},r.default.createElement("div",{className:"centerImgDiv-email"},r.default.createElement("img",{className:"centerImg-type3",src:S.default})),r.default.createElement("div",{style:{position:"relative"},className:"input-item"},r.default.createElement(m.default,{type:"text",ref:"phone",id:"emailMobile",placeholder:"请输入邮箱账号",onKeyUp:this.emailKeyUp,defaultValue:s?s.username:u}),r.default.createElement("div",{className:"emailSelect"},r.default.createElement("ul",null,r.default.createElement("li",null,r.default.createElement("span",null),r.default.createElement("a",null,"@qq.com")),r.default.createElement("li",null,r.default.createElement("span",null),r.default.createElement("a",null,"@163.com")),r.default.createElement("li",null,r.default.createElement("span",null),r.default.createElement("a",null,"@126.com")),r.default.createElement("li",null,r.default.createElement("span",null),r.default.createElement("a",null,"@139.com")),r.default.createElement("li",null,r.default.createElement("span",null),r.default.createElement("a",null,"@189.cn")),r.default.createElement("li",null,r.default.createElement("span",null),r.default.createElement("a",null,"@sina.com")),r.default.createElement("li",null,r.default.createElement("span",null),r.default.createElement("a",null,"@sohu.com")),r.default.createElement("li",null,r.default.createElement("span",null),r.default.createElement("a",null,"@hotmail.com")),r.default.createElement("li",null,r.default.createElement("span",null),r.default.createElement("a",null,"@21cn.com")))),r.default.createElement("div",{onClick:this.clearValue,className:"tex_box"},r.default.createElement("span",{className:"textt"}))),r.default.createElement("div",{className:"input-item"},r.default.createElement(m.default,{type:this.state.Type,ref:"password",id:"emailPassword",defaultValue:l,placeholder:"请输入密码"}),r.default.createElement("div",{onClick:this.showPwd,className:"tex_box"},r.default.createElement("span",{className:"password password_show"})))),r.default.createElement(P.default,{ref:"agreementField",uid:"0",frontConf:this.state.frontConf}),r.default.createElement("div",{className:"page-wrapper email_spinner"},r.default.createElement(y.default,{types:"full",onTap:function(){e.handleImport()},disable:o,state:o,getState:function(e){switch(e){case!1:return"提交";case!0:return"登录中...";default:return"提交"}}}),r.default.createElement("div",{className:"tip"},r.default.createElement("div",null,"温馨提示:"),"*请授权有信用卡账单的邮箱")));return r.default.createElement("div",null,r.default.createElement(v.default,null,c))},handleImport:function(){var e=this;if(!this.refs.agreementField.isChecked(w.AGREEMENT_TYPE.MOXIE))return void setTimeout(function(){return u.default.alert("请勾选同意《用户使用协议》","")});if(!this.refs.agreementField.isChecked(w.AGREEMENT_TYPE.TENANT))return void setTimeout(function(){return u.default.alert("请勾选同意《用户使用协议》","")});var t=this.submitTask;if(!this.refs.phone.getValue()||!I.test(this.refs.phone.getValue()))return void setTimeout(function(){return u.default.alert("请输入正确的邮箱账号","")});if(!this.refs.password.getValue())return void setTimeout(function(){return u.default.alert("请输入密码","")});this.setState({isStart:!0});var a=this.refs.phone.getValue(),n=this.refs.password.getValue(),o=!1;try{"function"==typeof window.mxRelogin&&(o=!0)}catch(e){}try{"function"==typeof android.mxRelogin&&(o=!0)}catch(e){}u.default.Device.SDK&&o?!function(){var o=a.split("@"),r=o[0],l=o[1];(0,s.fetchList)({taskType:"email"}).then(function(e){for(var o in e)if(l==e[o].host&&"1"==e[o].items.isCanUseWebLogin)return void u.default.mxRelogin({taskType:"email",userAgent:e[o].items.userAgent,loginUrl:e[o].items.loginUrl,jsUrl:e[o].items.jsurl,host:e[o].host,replace:!0,account:r,password:n});t(a,n)}).catch(function(t){return e.setState({fail:!0})})}():t(a,n)},submitTask:function(e,t){var a=this,n=(this.state.phoneInfo,this.onSubmitTaskDone);(0,s.submitTaskHelper)({taskType:"email",username:e,password:t}).then(function(t){if(t.body.task_id){a.setState({isStart:!1}),u.default.refreshStatus("2","创建任务成功"),u.default.mxSaveTaskId(t.body.task_id);var o={taskId:t.body.task_id,email_id:t.body.email_id,username:e,taskType:"email",loginParam:{phone:e}};n(o),d.default.set("email",0,0,0,{loginParam:{phone:e}})}}).catch(function(e){a.setState({isStart:!1});var t=e&&e.response&&e.response.body||{};t.errors&&t.errors[0]&&(10220011===t.errors[0].code||10220012===t.errors[0].code)?(u.default.refreshStatus("-2",t.errors[0].message),a.showUnsupport(t.errors[0].message)):(u.default.refreshStatus("-3","服务异常，创建任务失败"),a.handleError(e,t.detail))})},handleError:function(e){var t=arguments.length<=1||void 0===arguments[1]?"任务提交失败":arguments[1];try{t=e&&e.body&&e.body.detail||t}catch(e){console.log(e)}if("任务提交失败"==t){if(e&&e.message&&e.message.indexOf("the network is offline")!=-1)return void u.default.alert("网络开小差啦，请稍后再试");u.default.alert(t+"\n"+e)}else u.default.alert(t);this.setState({isStart:!1})},showPwd:function(){"text"==this.state.Type?(this.setState({Type:"password"}),document.getElementsByClassName("password_show")[0].style.backgroundImage="url("+a(20)+")"):(this.setState({Type:"text"}),document.getElementsByClassName("password_show")[0].style.backgroundImage="url("+a(36)+")")},clearValue:function(){document.getElementById("emailMobile").getElementsByTagName("input")[0].value=""},showUnsupport:function(e){this.setState({unsupport:e||this.state.unsupport,showUnsupport:!0})},onSubmitTaskDone:function(e){return e.importResult={},this.props.onSubmitTaskDone(e),!0},emailKeyUp:function(){if(this.refs.phone.getValue().indexOf("@")!=-1){document.getElementsByClassName("emailSelect")[0].style.display="block";for(var e=this.refs.phone.getValue().indexOf("@"),t=this.refs.phone.getValue().substring(e),a=document.getElementsByClassName("emailSelect")[0].getElementsByTagName("li"),n=0;n<a.length;n++)a[n].style.display="none",a[n].getElementsByTagName("a")[0].innerHTML.indexOf(t)!=-1&&(a[n].style.display="block",a[n].getElementsByTagName("span")[0].innerHTML=this.refs.phone.getValue().substring(0,e),a[n].getElementsByTagName("a")[0].innerHTML==t&&(document.getElementsByClassName("emailSelect")[0].style.display="none"))}else document.getElementsByClassName("emailSelect")[0].style.display="none"}});t.default=O,e.exports=t.default}).call(this)}finally{}},268:function(e,t,a){e.exports=a.p+"assets/81f0cdd1.email_logo_icn_yx@3x.png"},806:function(e,t,a){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),u=function(e,t,a){for(var n=!0;n;){var o=e,r=t,s=a;n=!1,null===o&&(o=Function.prototype);var l=Object.getOwnPropertyDescriptor(o,r);if(void 0!==l){if("value"in l)return l.value;var i=l.get;if(void 0===i)return;return i.call(s)}var u=Object.getPrototypeOf(o);if(null===u)return;e=u,t=r,a=s,n=!0,l=u=void 0}},c=a(2),d=n(c),f=a(1),p=a(24),m=a(19),h=n(m),y=a(8),g=a(14),k=n(g),v=a(226),T=n(v),b=a(15),E=n(b),S=a(11),w=(n(S),a(13)),P=(n(w),a(5)),I=(n(P),a(9)),O=n(I),C=a(6),_=n(C),x=a(7),N=n(x),q=a(21),L=n(q),D=a(17),U=a(22),A=n(U),B=a(39),M=a(12),j=n(M),F="此次尝试失败，请重试",z="验证完成",V="EmailImportTask",R=function(e){function t(e,t){r(this,a),u(Object.getPrototypeOf(a.prototype),"constructor",this).call(this,e,t),this.state={importState:"YES"===f.qsParams.continue?JSON.parse(storage.getItem(V)):null,currentPhone:Number(f.qsParams.mobile)?f.qsParams.mobile:"",taskStatus:D.TASK_STATUS.DEFAULT,isLoginDone:!1,showSpiner:!0,taskInfo:null,frontConf:j.default.frontConf[j.default.taskType]}}s(t,e),i(t,[{key:"componentDidMount",value:function(){PG.refreshTitle("邮箱登录")}},{key:"componentWillUnmount",value:function(){this.unmounted=!0}},{key:"render",value:function(){var e=this,t=(this.state.currentPhone,o(this.props,[])),a=void 0;return a=this.state.isLoginDone?this.state.taskStatus==D.TASK_STATUS.DEFAULT?d.default.createElement(L.default,{desc:this.state.desc}):d.default.createElement(A.default,{succ:this.state.taskStatus==D.TASK_STATUS.SUCC,taskInfo:this.state.taskInfo,desc:this.state.desc}):d.default.createElement("div",null,d.default.createElement(T.default,l({className:"importForm",frontConf:this.state.frontConf,onSubmitTaskDone:this.onSubmitTaskDone.bind(this)},t)),this.state.taskInfo&&this.state.showSpiner?d.default.createElement(E.default,{color:"#fff",showTips:this.state.desc}):null),d.default.createElement("div",{className:"import-carrier"},d.default.createElement("div",{className:"mx-view quan"},"NO"==f.qsParams.showTitleBar||0==f.qsParams.showTitleBar||PG.Device.SDK?null:d.default.createElement("div",{style:{height:"NO"==f.qsParams.showTitleBar||PG.Device.SDK?0:44}},d.default.createElement(_.default,{title:"邮箱登录",left:d.default.createElement(N.default,{onTap:function(){O.default.call(e)}},d.default.createElement("i",{className:"ion-chevron-left"}))})),a))}},{key:"onSubmitTaskDone",value:function(e){this.props.hideVCodeModal(),window.storage.setItem(V,JSON.stringify(e)),this.setState({taskInfo:e}),this.startPoll()}},{key:"startPoll",value:function(){(0,h.default)({task:this.state.taskInfo,isLogin:!1,callbacks:{waitCode:this.initVCode.bind(this),doneLogin:this.doneLogin.bind(this),doneSucc:this.onSucc.bind(this),doneFail:this.onFail.bind(this),doneTimeout:this.onFail.bind(this),doing:this.updateState.bind(this),pendingTimeout:this.onPendingTimeout.bind(this),error:this.onError.bind(this)}})}},{key:"initVCode",value:function(e,t){var a=this;return this.setState({showSpiner:!1}),this.props.showVCodeModal({title:"验证码",desc:t.description,waitSeconds:0,type:t.input.type,imgSrc:"img"==t.input.type?t.input.value:"",onConfirm:function(t){a.submitVCode(t,e),a.setState({showSpiner:!0})},onCancel:function(){a.storeLoginInfo(e,!0),a.setState({taskInfo:null,showSpiner:!0})}}),this.updateState(e,t),!0}},{key:"submitVCode",value:function(e,t){var a=this;(0,y.submitVCode)(e,t).catch(function(e){console.log(e)}).then(function(){return a.startPoll()})}},{key:"doneLogin",value:function(e,t){this.updateState(e,t),this.setState({isLoginDone:!0})}},{key:"removeTaskStore",value:function(){window.storage.removeItem(V)}},{key:"updateState",value:function(e,t){return this.setState({phase:t.phase,desc:t.description,isLoginDone:t.phase!==p.PHASE.LOGIN}),!!this.unmounted}},{key:"storeLoginInfo",value:function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];this.removeTaskStore(),this.props.params.cardType||f.qsParams.cardType,void 0==e.bankId&&(e.bankId=0),void 0==e.loginModel&&(e.loginModel=0),void 0==e.loginType&&(e.loginType=0),k.default.set(e.taskType,0,0,e.loginType,{loginParam:e.loginParam,loginFail:t})}},{key:"onSucc",value:function(e,t){this.storeLoginInfo(e),t.description=z,this.updateState(e,t),this.setState({taskStatus:D.TASK_STATUS.SUCC})}},{key:"onFail",value:function(e,t){this.storeLoginInfo(e,!0),t.phase!=p.PHASE.LOGIN&&this.setState({taskStatus:D.TASK_STATUS.FAIL,desc:t.description}),this.setState({taskInfo:null})}},{key:"onPendingTimeout",value:function(e){this.storeLoginInfo(e),this.setState({taskStatus:D.TASK_STATUS.FAIL,desc:F,taskInfo:null})}},{key:"onError",value:function(e,t){console.log(t),this.storeLoginInfo(e,!0),this.setState({taskStatus:D.TASK_STATUS.FAIL,desc:"服务异常,请稍后再试",taskInfo:null})}},{key:"handleBack",value:function(){(this.state.isLoginDone||this.state.isFail)&&(f.qsParams.backUrl||f.qsParams.back_url)?quitBack({taskType:"email"}):(this.unmounted=!0,O.default.call(this))}}],[{key:"propTypes",value:{showVCodeModal:c.PropTypes.func,hideVCodeModal:c.PropTypes.func},enumerable:!0}]);var a=t;return t=(0,B.observer)(t)||t}(d.default.Component);t.default=R,e.exports=t.default}).call(this)}finally{}}});