webpackJsonp([63],{228:function(t,e,a){try{(function(){"use strict";function e(t){return t&&t.__esModule?t:{default:t}}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function i(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=function(){function t(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,a,n){return a&&t(e.prototype,a),n&&t(e,n),e}}(),r=function(t,e,a){for(var n=!0;n;){var i=t,s=e,r=a;n=!1,null===i&&(i=Function.prototype);var l=Object.getOwnPropertyDescriptor(i,s);if(void 0!==l){if("value"in l)return l.value;var c=l.get;if(void 0===c)return;return c.call(r)}var o=Object.getPrototypeOf(i);if(null===o)return;t=o,e=s,a=r,n=!0,l=o=void 0}},l=a(2),c=e(l),o=a(16),u=a(6),d=e(u),f=a(7),h=e(f),m=a(18),y=e(m),p=a(11),v=e(p),_=a(1),b=a(9),E=e(b),g=a(8),k=a(113),N=a(10),w=e(N),S=function(t){function e(t,a){n(this,e),r(Object.getPrototypeOf(e.prototype),"constructor",this).call(this,t,a),this.renderFunds=this.renderFunds.bind(this),this.handleNext=this.handleNext.bind(this),this.handleChange=this.handleChange.bind(this),this.clearIptval=this.clearIptval.bind(this),this.state={funds:[],name:"",fail:!1,current_city:"",show_item:"block",hot_city:[],current_code:"",noval:"none",hotCity:"",city_status:"",flag:!1,display_all:!this.props.params||!this.props.params.province},this.data=[],this.val=""}return i(e,t),s(e,[{key:"componentDidMount",value:function(){var t=this;PG.refreshTitle("选择公积金城市"),(0,g.fetchList)({taskType:"fund",options:{type:"city",province:this.props.params&&this.props.params.province||""}}).then(function(e){t.setState({funds:e}),t.data=e}).catch(function(e){return t.setState({fail:!0})}),this.state.display_all&&this.getCurrentCity()}},{key:"getCurrentCity",value:function(){var t=this;this.setState({current_city:"正在获取中..."}),window.locate=function(e){var a=e&&e.content&&e.content.address_detail.city,n=void 0;return a&&""!=a?(a=a.replace("市",""),n="北京"==a||"天津"==a||"上海"==a||"重庆"==a?a:e&&e.content&&e.content.address_detail.province&&e.content.address_detail.province.replace("省","")||null,void(0,g.fetchList)({taskType:"fund",options:{type:"city",province:n}}).then(function(e){var n=!1;e.map(function(e){a==e.city_name&&(n=!0,t.setState({current_code:e.area_code,city_status:e.status}),t.setState({current_city:1!=e.status?a:a+"(正在维护中)"}))}),n||t.setState({city_status:1,current_city:a+"(暂不支持)"})})):void t.setState({current_city:"无法获取您的定位"})};var e=document.querySelector("#fundPosition");e&&document.body.removeChild(e);var a=document.createElement("script");a.src="https://api.map.baidu.com/location/ip?ak=uZMTxGSHnl4j6Bi1DtY2e4XtBzrSbXyz&callback=locate",a.id="fundPosition",document.getElementsByTagName("body")[0].appendChild(a)}},{key:"render",value:function(){var t=this,e=this.renderFunds();return this.state.fail&&(e=c.default.createElement("div",{className:"centered"},"网络异常,请稍后再试")),c.default.createElement("div",{className:"mx-view bank-list-page"},"NO"==_.qsParams.showTitleBar||0==_.qsParams.showTitleBar||PG.Device.SDK?null:c.default.createElement("div",{ref:"titleBar",style:{height:"NO"==_.qsParams.showTitleBar||PG.Device.SDK?0:44}},c.default.createElement(d.default,{title:"选择公积金城市",left:c.default.createElement(h.default,{onTap:function(){E.default.call(t)}},c.default.createElement("i",{className:"ion-chevron-left"}))})),c.default.createElement(y.default,null,e))}},{key:"handleChange",value:function(t){for(var e=this.refs.city_val.value,a=[],n=0;n<this.data.length;n++)e!=this.data[n].city_name&&(0,k.pinyin)(this.data[n].city_name)!=e.toLowerCase().trim()||a.push(this.data[n]);for(var n=0;n<this.data.length;n++)if(this.data[n].city_name.indexOf(e)!=-1||(0,k.pinyin)(this.data[n].city_name).indexOf(e.toLowerCase().trim())!=-1){for(var i=!1,s=0;s<a.length;s++)a[s]==this.data[n]&&(i=!0);i||a.push(this.data[n])}0==a.length&&this.setState({flag:!0}),this.setState({funds:a}),8!=t.keyCode&&this.setState({show_item:"none",noval:"block"}),""==e.trim()&&this.setState({funds:this.data,show_item:"block",noval:"none"})}},{key:"renderFunds",value:function(){var t=this,e=this.state,a=e.funds,n=e.flag,i=this.handleNext;return 0!==a.length||n?(a=a.sort(function(t,e){return(0,k.makePy)(t.city_name)[0]>(0,k.makePy)(e.city_name)[0]?1:-1}),c.default.createElement("div",null,c.default.createElement("div",{ref:"fund_mask",className:"fund_mask"},c.default.createElement("div",{ref:"d_mask",id:"d_mask"})),c.default.createElement("div",{ref:"searchBox",className:"d-search"},c.default.createElement("span",{className:"search_img"}),c.default.createElement("input",{ref:"city_val",id:"val",onChange:function(e){t.handleChange(e)},type:"text",placeholder:"可输入中文、拼音进行查找城市"}),c.default.createElement(w.default,{onTap:this.clearIptval},c.default.createElement("span",{style:{display:this.state.noval},className:"clear_img"}))),c.default.createElement("div",{style:{position:"absolute",top:"NO"==_.qsParams.showTitleBar||0==_.qsParams.showTitleBar||PG.Device.SDK?"44px":"84px",left:0,right:0,bottom:0,overflowY:"scroll",WebkitOverflowScrolling:"touch"}},c.default.createElement("ul",{ref:"city_list",id:"city_list",style:{backgroundColor:"white"}},this.state.display_all?c.default.createElement("div",{style:{display:this.state.show_item}},c.default.createElement("p",{className:"current_city_p"},"当前城市"),c.default.createElement(w.default,{onTap:this.state.current_code&&1!=this.state.city_status?function(){return t.handleNext(t.state.city,t.state.current_code)}:function(){}},c.default.createElement("div",{className:"current_city",style:{display:this.state.show_item}},c.default.createElement("p",{className:"urrent_city_p_Sec",style:{color:1==this.state.city_status?"#cdcdcd":"#333"}},c.default.createElement("i",{className:"cityicon ion-location"}),c.default.createElement("span",{className:"citycontext"},this.state.current_city))))):null,c.default.createElement("p",{className:"current_city_p"},"城市列表"),a.map(function(t,e){return c.default.createElement("div",{key:"itemList_"+e,className:"itemList"},c.default.createElement("li",{className:(0,k.makePy)(t.city_name)[0].substring(0,1),key:"cname"+e},c.default.createElement(w.default,{onTap:1==t.status?function(){return!1}:i.bind(null,t.city_name,t.area_code)},c.default.createElement("div",{className:"bank-item"},c.default.createElement("i",{className:"icon i-"+t.area_code}),c.default.createElement("span",{className:1==t.status?"tit-st":"tit"},1==t.status?t.city_name+"(正在维护中)":t.city_name),c.default.createElement("b",{className:"bank-itemico ion-ios-arrow-right"})))))}))))):c.default.createElement("div",{className:"centered"},c.default.createElement(v.default,{size:"44",color:"#999"}))}},{key:"handleNext",value:function(t,e){var a=this.context.history.pushState;a({city_name:t},"/fund/"+e,_.qsParams)}},{key:"clearIptval",value:function(){this.refs.city_val.value="",this.setState({funds:this.data,show_item:"block",noval:"none"}),""!=this.state.hot_city&&this.setState({hotCity:"block"})}}]),e}(c.default.Component);S.contextTypes={history:o.PropTypes.history},t.exports=S}).call(this)}finally{}}});