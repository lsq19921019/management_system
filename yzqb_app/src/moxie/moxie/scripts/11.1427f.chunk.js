webpackJsonp([11,53],{15:function(e,t,a){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=function(e,t,a){for(var n=!0;n;){var o=e,r=t,i=a;n=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,r);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(i)}var u=Object.getPrototypeOf(o);if(null===u)return;e=u,t=r,a=i,n=!0,s=u=void 0}},u=a(2),d=n(u),c=a(16),p=a(10),f=(n(p),a(1)),m=function(e){function t(e,a){r(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,a),this.state={}}return i(t,e),s(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.showTips,a=e.showOrHideSpinner,n=e.size,r=e.color,i=e.boxSize,s=(o(e,["showTips","showOrHideSpinner","size","color","boxSize"]),{display:a,width:"100%",maxWidth:f.qsParams.maxWidth?f.qsParams.maxWidth:"800px",height:f.qsParams.height?f.qsParams.height+"px":"100%",position:"fixed",right:0,bottom:0,margin:"0 auto",left:0,top:0,zIndex:996,background:"rgba(0,0,0,.4)"});return d.default.createElement("div",{style:s},d.default.createElement("div",{className:"SpinerBox",style:{overflow:"hidden",background:"rgba(22,22,22,0.8)",position:"absolute",top:"40%",left:"50%",width:""+i,height:""+i,borderRadius:"10px"}},d.default.createElement("div",{className:"newSpiner",style:{top:t?i/6+"px":(i-n)/2+"px"}},d.default.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",width:n,height:n,fill:r},d.default.createElement("path",{opacity:".25",d:"M16 0 A16 16 0 0 0 16 32 A16 16 0 0 0 16 0 M16 4 A12 12 0 0 1 16 28 A12 12 0 0 1 16 4"}),d.default.createElement("path",{d:"M16 0 A16 16 0 0 1 32 16 L28 16 A12 12 0 0 0 16 4z"}))),d.default.createElement("div",{style:{color:"#fff",textAlign:"center",width:"100%",fontSize:"13px",position:"absolute",top:""+2*i/3}},t)))}}]),t}(d.default.Component);t.default=m,m.contextTypes={history:function(){return c.PropTypes.history}},m.defaultProps={boxSize:120,size:48,showTips:"正在加载",color:"#fff"},e.exports=t.default}).call(this)}finally{}},17:function(e,t,a){try{(function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e={DEFAULT:"DEFAULT",SUCC:"SUCC",FAIL:"FAIL"};t.TASK_STATUS=e}).call(this)}finally{}},19:function(e,t,a){try{(function(){"use strict";function e(e){return e&&e.__esModule?e:{default:e}}function n(e){var t=e.task,a=e.callbacks;a=l({waitCode:u.noop,doneSucc:u.noop,doneFail:u.noop,doneTimeout:u.noop,doneLogin:u.noop,pendingTimeout:u.noop,doing:u.noop,error:u.noop,spiner:u.noop,showProgress:u.noop,importSucc:u.noop,onError:u.noop,errorCatch:u.noop,refreshImgCode:u.noop,setqrCodeTaskInfo:u.noop,doneScan:u.noop,zxBankSpiner:u.noop,showQrcodeInCrawlStatus:u.noop,hideQrCode:u.noop},a);var c,p=o(t),f=u.request.get(p+("?d="+Date.now())).set(l({},m.default.addDefaultHeaders())).set("Accept","application/json").set("Cache-Control","no-store");return c="carrier"==t.taskType?(0,u.guardTimeoutLongtime)(f):(0,u.guardTimeout)(f),c.then(function(e){var o=!1;if(a.setqrCodeTaskInfo&&"qrcode"==t.loginType&&a.setqrCodeTaskInfo(t),a.showProgress&&a.showProgress(e.body.description),"LOGIN"!=e.body.phase&&(a.doneLogin&&(o=a.doneLogin(t,e.body)),"alipay"==t.taskType&&"WAIT_CODE"!=e.body.phase_status&&a.hideQrCode&&a.hideQrCode(),r(t),(d.qsParams.quitOnLoginDone||d.qsParams.canLeave)&&"zhengxin"!=t.taskType))return o=!0,!1;switch("LOGIN"==e.body.phase&&"WAIT_CODE"!=e.body.phase_status&&a.doneScan&&a.doneScan(),e.body.phase_status){case b.WAIT_CODE:a.spiner&&a.spiner(),a.zxBankSpiner&&a.zxBankSpiner(),a.waitCode&&(o=a.waitCode(t,e.body));break;case b.CONTINUE:a.spiner&&a.spiner(),a.zxBankSpiner&&a.zxBankSpiner(),a.waitCode&&a.waitCode(t,e.body);break;case b.DONE_SUCC:e.body.finished===!0?(a.zxBankSpiner&&a.zxBankSpiner(),storage.setItem(t.taskType+"ImportStatus","succ"),setTimeout(function(){a.spiner&&a.spiner(),a.showProgress&&a.showProgress(""),k.default.refreshStatus("1",e.body.description)},3e3),a.importSucc&&a.importSucc(e.body),a.doneSucc&&a.doneSucc(t,e.body),o=!0,i(t)):a.doing&&(o=a.doing(t,e.body));break;case b.DONE_FAIL:a.hideQrCode&&a.hideQrCode(),storage.setItem(t.taskType+"ImportStatus","fail"),"LOGIN"===e.body.phase?("BALO-23001-10"==e.body.error_code&&a.doneTimeout&&a.doneTimeout(t,e.body),a.refreshImgCode(),k.default.refreshStatus("-4",e.body.description)):k.default.refreshStatus("0",e.body.description),a.zxBankSpiner&&a.zxBankSpiner(),setTimeout(function(){a.spiner&&a.spiner(),a.showProgress&&a.showProgress("")},3e3),a.doneFail&&a.doneFail(t,e.body),o=!0,s(t,e);break;case b.DONE_TIMEOUT:a.hideQrCode&&a.hideQrCode(),storage.setItem(t.taskType+"ImportStatus","fail"),"LOGIN"===e.body.phase?k.default.refreshStatus("-4",e.body.description,t.loginType,e.body.phase):k.default.refreshStatus("0",e.body.description,t.loginType,e.body.phase),a.doneTimeout&&a.doneTimeout(t,e.body),o=!0,s(t,e);break;case b.DOING:k.default.refreshStatus("2",e.body.description,t.loginType,e.body.phase),a.doing&&(o=a.doing(t,e.body));break;default:k.default.refreshStatus("-3","异常错误"),a.doneFail&&a.doneFail(t,e.body),o=!0,s(t,e)}"LOGIN"!=e.body.phase,o||setTimeout(function(){n({task:t,callbacks:a})},v)}).catch(function(e){var n=e&&e.body&&e.body.detail||e;k.default.alert("服务异常，请稍候再试！"+n),a.zxBankSpiner&&a.zxBankSpiner(),a.spiner&&a.spiner(),a.onError&&a.onError(t,e),a.error&&a.error(t,e),a.errorCatch&&a.errorCatch(e)})}function o(e){var t="";return t="bank"==e.taskType?p.default.checkImportState.replace("{taskid}",e.taskId):"carrier"==e.taskType?p.default.checkCarrierImportStatev2.replace("{taskid}",e.taskId):"chsi"==e.taskType?p.default.checkChsiImportState.replace("{taskid}",e.taskId):"fund"==e.taskType?p.default.checkFundImportState.replace("{taskid}",e.taskId):"email"==e.taskType||"qq"==e.taskType?p.default.checkEmailImportState.replace("{taskid}",e.taskId):"tax"==e.taskType?p.default.taxStatus.replace("{task_id}",e.taskId)+("?d="+Date.now()):"security"==e.taskType?p.default.checkSecurityImportState.replace("{taskid}",e.taskId)+("?d="+Date.now()):"alipay"==e.taskType||"wechat"==e.taskType?p.default.commonImportStateUrlv2.replace("{taskid}",e.taskId):"sametrade"==e.taskType?p.default.checkSametradeTaskStatus.replace("{task_id}",e.taskId):p.default.commonImportStateUrl.replace("{taskid}",e.taskId)}function r(e){k.default.mxHideWebView(),k.default.mxCanLeave(!0),k.default.loginDone=1,(d.qsParams.canLeave||d.qsParams.quitOnLoginDone)&&"zhengxin"!=e.taskType&&(console.log("finishImport"),k.default.finishImport(e.taskId,"2","登录认证成功","SUCC"),(0,g.default)({taskType:e.taskType}))}function i(e){k.default.finishImport(e.taskId,"1","认证成功","SUCC"),(0,g.default)({taskType:e.taskType})}function s(e,t){console.log("handleDoneFail"),"LOGIN"===t.body.phase?"zhengxin"!=e.taskType&&("qrcode"==e.loginType&&"DONE_TIMEOUT"==t.body.phase_status||k.default.alert(t.body.description)):(k.default.finishImport(e.taskId,"0",t.description,"FAIL"),d.qsParams.quitOnFail&&(0,g.default)({taskType:e.taskType}))}Object.defineProperty(t,"__esModule",{value:!0});var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},u=a(1),d=a(1),c=a(25),p=e(c),f=a(12),m=e(f),h=a(29),g=e(h),y=a(4),k=e(y),v=2500,b={DOING:"DOING",WAIT_CODE:"WAIT_CODE",DONE_SUCC:"DONE_SUCC",DONE_FAIL:"DONE_FAIL",DONE_TIMEOUT:"DONE_TIMEOUT"};t.STATE=b,t.default=n}).call(this)}finally{}},21:function(e,t,a){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=function(e,t,a){for(var n=!0;n;){var o=e,r=t,i=a;n=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,r);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(i)}var u=Object.getPrototypeOf(o);if(null===u)return;e=u,t=r,a=i,n=!0,s=u=void 0}},l=a(2),u=n(l),d=function(e){function t(e,a){o(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,a)}return r(t,e),i(t,null,[{key:"propTypes",value:{desc:l.PropTypes.string.isRequired},enumerable:!0}]),i(t,[{key:"render",value:function(){var e=u.default.createElement("img",{style:{width:"350px"},src:a(45)});return u.default.createElement("div",{className:"waiting-view"},u.default.createElement("h3",{style:{width:"80%",textAlign:"center",fontSize:"16px",color:"#70BEEB",height:"50px",lineHeight:"50px",borderBottom:"1px solid #efeff4"}},"获取结果中..."),u.default.createElement("h4",{style:{height:"20px",fontSize:"14px",color:"#666666"}},this.props.desc),u.default.createElement("div",{className:"waiting-gif"},e))}}]),t}(u.default.Component);t.default=d,e.exports=t.default}).call(this)}finally{}},22:function(e,t,a){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),s=function(e,t,a){for(var n=!0;n;){var o=e,r=t,i=a;n=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,r);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(i)}var u=Object.getPrototypeOf(o);if(null===u)return;e=u,t=r,a=i,n=!0,s=u=void 0}},l=a(2),u=n(l),d=a(1),c=a(23),p=a(5),f=n(p),m=(a(17),function(e){function t(e,a){o(this,t),s(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,a),this.state={}}return r(t,e),i(t,null,[{key:"propTypes",value:{succ:l.PropTypes.bool.isRequired,taskInfo:l.PropTypes.any.isRequired,canQuitAuth:l.PropTypes.bool},enumerable:!0}]),i(t,[{key:"render",value:function(){var e=this,t={color:void 0!=d.qsParams.themeColor?"#"+d.qsParams.themeColor:c.DEFAULT_THEMECOLOR,fontSize:"12px"},a=void 0!=d.qsParams.themeColor?"#"+d.qsParams.themeColor:c.DEFAULT_THEMECOLOR,n=null;return n=this.props.succ?u.default.createElement("div",{className:"finish-status succ"},u.default.createElement("svg",{width:"48",height:"48",viewBox:"0 0 48 48"},u.default.createElement("g",{className:"transform-group"},u.default.createElement("g",{transform:"scale(0.046875, 0.046875)"},u.default.createElement("path",{d:"M511.996387 9.862132c-277.328216 0-502.134255 224.813265-502.134255 502.137868 0 277.328216 224.80604 502.137868 502.134255 502.137868 277.320991 0 502.137868-224.809652 502.137868-502.137868C1014.137868 234.675397 789.320991 9.862132 511.996387 9.862132L511.996387 9.862132zM824.889692 388.748635l-351.388132 338.834686c-4.670966 4.663741-9.952445 8.337656-15.587949 11.028971-22.065166 15.761349-52.915939 13.75641-72.730516-6.061779l-150.897848-150.897848c-22.065166-22.065166-22.065166-57.832555 0-79.883271 22.054329-22.065166 57.821717-22.065166 79.886884 0l113.291695 113.28447 317.531758-306.192112c22.061554-22.061554 57.832555-22.061554 79.883271 0C846.954858 330.919692 846.954858 366.687081 824.889692 388.748635L824.889692 388.748635zM824.889692 388.748635",fill:a})))),u.default.createElement("p",{style:t},"验证成功"),d.qsParams.token?u.default.createElement(f.default,{types:"full",style:"width:50%;height:44px;",onTap:function(){e.onSuccDetailButtonClick()}},"详情查询"):null):u.default.createElement("div",{className:"finish-status fail"},u.default.createElement("i",{className:"import-fail-img"}),u.default.createElement("p",{className:"fail-desc",style:{marginBottom:"20px"}},this.props.desc),"YES"!=d.qsParams.notRetryOnFail&&1!=d.qsParams.notRetryOnFail?u.default.createElement(f.default,{types:"full",style:"width:50%;height:44px;",onTap:function(){e.retryButtonClick()}},"点击重试"):null),u.default.createElement("div",{className:"waiting-view"},u.default.createElement("div",{className:"waiting-gif"},n))}},{key:"retryButtonClick",value:function(){window.location.reload()}},{key:"retryButtonClick",value:function(){window.location.reload()}},{key:"onSuccDetailButtonClick",value:function(){if(void 0==d.qsParams.token)return void PG.alert("缺少token值");var e=this.props.taskInfo,t=(0,d.getENV)(),a="";a="test"==t?"http://192.168.0.11:8282":"pre"==t||"qa"==t?"https://qa.51datakey.com":"https://api.51datakey.com";var n="";switch(e.taskType){case"email":n=a+"/h5/resultV3/index.html#/emailResult?taskId="+e.taskId+"&token="+d.qsParams.token+"&mainTitle="+d.qsParams.mainTitle+"&icoUrl="+d.qsParams.icoUrl;break;case"bank":n=a+"/h5/resultV3/index.html#/bankResult/?taskId="+e.taskId+"&token="+d.qsParams.token+"&mainTitle="+d.qsParams.mainTitle+"&icoUrl="+d.qsParams.icoUrl;break;case"carrier":n=a+"/h5/resultV4/carrier/index.html?taskId="+e.account+"&token="+d.qsParams.token+"&mainTitle="+d.qsParams.mainTitle+"&icoUrl="+d.qsParams.icoUrl;break;case"shixin":n=a+"/h5/resultV4/shixin/index.html?taskId="+e.taskId+"&token="+d.qsParams.token+"&mainTitle="+d.qsParams.mainTitle+"&icoUrl="+d.qsParams.icoUrl;break;case"tax":n=a+"/h5/resultV4/tax/index.html?taskId="+e.taskId+"&token="+d.qsParams.token+"&mainTitle="+d.qsParams.mainTitle+"&icoUrl="+d.qsParams.icoUrl;break;case"zhixing":n=a+"/h5/resultV4/zhixing/index.html?taskId="+e.taskId+"&token="+d.qsParams.token+"&mainTitle="+d.qsParams.mainTitle+"&icoUrl="+d.qsParams.icoUrl;break;default:n=a+"/h5/resultV3/index.html#/"+e.taskType+"?taskId="+e.taskId+"&token="+d.qsParams.token+"&mainTitle="+d.qsParams.mainTitle+"&icoUrl="+d.qsParams.icoUrl}"test"==t?n+="&env=test":"pre"!=t&&"qa"!=t||(n+="&env="+t),window.location.href=n}}]),t}(u.default.Component));t.default=m,e.exports=t.default}).call(this)}finally{}},23:function(e,t,a){try{(function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e="#58B5EB";t.DEFAULT_THEMECOLOR=e}).call(this)}finally{}},24:function(e,t,a){try{(function(){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var e={LOGIN:"LOGIN",RECEIVE:"RECEIVE",EXTRACT:"EXTRACT",STORE:"STORE",DONE:"DONE"};t.PHASE=e}).call(this)}finally{}},235:function(e,t,a){try{(function(){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var o=a(2),r=n(o),i=a(53),s=n(i),l=a(8),u=a(14),d=n(u),c=a(1),p=a(4),f=n(p),m=a(10),h=n(m),g=a(13),y=n(g),k=a(5),v=n(k),b=a(11),T=(n(b),a(40)),S=a(85).Base64,I=r.default.createClass({displayName:"index",propTypes:{pageConfig:o.PropTypes.object.isRequired,inMemoryLogin:o.PropTypes.object,platformId:o.PropTypes.string.isRequired},getInitialState:function(){return{loginTypeIndex:0,isStart:!1,preGetImgCode:!1}},getDefaultProps:function(){return{auto:0,inMemoryLogin:null}},componentDidMount:function(){var e=this,t=this.props.pageConfig,a=(0,T.getParams)("loginParams");if(a){var n=!1;t.fields.map(function(e,o){a[t.login_type]&&a[t.login_type][e.name]||(n=!0)}),n||(this.timer=setInterval(function(){var a=!1;t.fields.map(function(t,n){e.refs[t.name]||(a=!0)}),a||(clearInterval(e.timer),e.handleImport())},100))}var o=this.autoImport,r=this.props.inMemoryLogin;if(this.isMounted=!0,r&&r.loginType){for(var i=0,s=0;s<1;s++)if(t.login_type===r.loginType){i=s;break}this.setState({loginTypeIndex:i},o)}},componentWillUnmount:function(){this.isMounted=!1},render:function(){var e=this.handleImport,t=this.handleProtocol,a=this.renderInputs,n=this.state.isStart,o=this.props,i=o.pageConfig,s=o.preGetImgCode,l=o.imgCode,u=o.getVcodeAgain,d=void 0!=c.qsParams.agreementEntryText?c.qsParams.agreementEntryText:"同意《用户使用协议》",p=a(),f=({backgroundColor:"#"+c.qsParams.themeColor},r.default.createElement("div",{className:"config-import-page"},p.length>0?r.default.createElement("div",{className:"form common-form"},p,1==s?r.default.createElement("div",{className:"input-item"},r.default.createElement(y.default,{key:"img",type:"text",ref:"imgCode",placeholder:"点击图片可刷新",label:"图片验证码"}),r.default.createElement("span",{onClick:u,style:{position:"absolute",right:0,top:"1px",width:"100px",height:"49px",background:"#f1f1f1"}},r.default.createElement("img",{style:{width:"100%",height:"100%"},src:"data:image/png;base64,"+l,alt:""}))):null):null,r.default.createElement("div",{style:{display:"NO"==c.qsParams.showAgreement||0==c.qsParams.showAgreement?"none":"block"},className:"protocol"},r.default.createElement("input",{id:"protocol"+i.login_type,ref:"protocol"+i.login_type,type:"checkbox",defaultChecked:!0}),r.default.createElement("label",{htmlFor:"protocol"+i.login_type},r.default.createElement("span",{style:{background:c.qsParams.themeColor?"#"+c.qsParams.themeColor:"rgb(126, 195, 235)"}})),r.default.createElement(h.default,{onTap:t},r.default.createElement("a",null,d))),c.qsParams.tenantAgreementUrl?r.default.createElement("div",{className:"protocol"},r.default.createElement("input",{id:"tanent_protocol"+i.login_type,ref:"tanent_protocol"+i.login_type,type:"checkbox",defaultChecked:!0}),r.default.createElement("label",{htmlFor:"tanent_protocol"+i.login_type},r.default.createElement("span",{style:{background:c.qsParams.themeColor?"#"+c.qsParams.themeColor:"rgb(126, 195, 235)"}})),r.default.createElement(h.default,{onTap:this.handleTanentProtocol},r.default.createElement("a",null,c.qsParams.tenantAgreementEntryText||"同意《用户使用协议》"))):null,r.default.createElement("div",{className:"page-wrapper"},r.default.createElement(h.default,{onTap:e},r.default.createElement(v.default,{types:"full",onTap:function(){},disable:n,state:n,getState:function(e){switch(e){case!1:return"提交";case!0:return"登录中...";default:return"提交"}}})))));return r.default.createElement("div",null,f)},showPwd:function(e,t){var n=s.default.findDOMNode(this.refs[e]).querySelector("input");"password"==n.type?(n.type="text",this.refs[e+"-span"].style.backgroundImage="url("+a(36)+")"):(n.type="password",this.refs[e+"-span"].style.backgroundImage="url("+a(20)+")")},clearVal:function(e){this.refs[e].setValue("")},renderInputs:function(){var e=this,t=this.tryGetCachedValue,a=(this.wrapValidator,this.state.loginTypeIndex,this.props.pageConfig),n=a,o=!1,i=void 0;try{i=(0,T.getParams)("loginParams")?(0,T.getParams)("loginParams"):{},i[a.login_type]&&(o=!0)}catch(e){console.log(e)}return n.fields.map(function(n,s){var l=t(n.name);if("select"==n.type){for(var u=[],d=0;d<n.list.length;d++)u.push(r.default.createElement("option",{key:d,value:n.list[d].value},n.list[d].key));var c=r.default.createElement("select",{ref:""+n.name,defaultValue:n.list[0].value},u);return r.default.createElement("div",{className:"input-item",key:n.fieldId},n.label,r.default.createElement("span",{className:"input-select"},c),r.default.createElement("p",{className:"input-tip"},n.des))}return r.default.createElement("div",{className:"input-item",key:n.fieldId},r.default.createElement(y.default,{key:a.login_type+"-"+n.label,type:""+n.type,ref:""+n.name,id:"inp"+s,defaultValue:o&&i[a.login_type][n.name]?i[a.login_type][n.name]:l,name:n.label,placeholder:"请输入"+n.label,label:n.label}),r.default.createElement("p",{className:"input-tip"},n.des),r.default.createElement("div",{className:"tex_box"},r.default.createElement("span",{ref:n.name+"-span",onClick:"password"==n.name?function(){return e.showPwd(n.name)}:function(){return e.clearVal(n.name)},className:"password"==n.name?n.name:"textt"})))})},handleImport:function(){function e(){d.default.set("sametrade",o,n.loginModel,n.login_type,{loginParam:u,loginFail:!0})}var t=this,a=(this.doneLogin,this.props),n=a.pageConfig,o=a.platformId,r=a.onSubmitTaskDone,i=a.preTaskId,s=(this.state.loginTypeIndex,n);if(!document.getElementById("protocol"+n.login_type).checked)return void setTimeout(function(){return f.default.alert("请勾选同意《用户使用协议》","")});if(this.refs["tanent_protocol"+n.login_type]&&!this.refs["tanent_protocol"+n.login_type].checked)return void setTimeout(function(){return f.default.alert("请勾选同意《用户使用协议》","")});var u=s.fields.reduce(function(e,a){if("select"==a.type){var n=t.refs[""+a.name].value;0==a.required&&""==n||(e[""+a.name]=n)}else{var n=t.refs[""+a.name].getValue();0==a.required&&""==n||(e[""+a.name]=n)}return e},{});for(var p in u)if(""==u[p])return void setTimeout(function(){return f.default.alert("请填写完整的信息!","")});var m=this.refs.imgCode&&this.refs.imgCode.getValue()||"";if(this.refs.imgCode&&!m)return alert("请输入图片验证码！"),null;this.setState({isStart:!0});var h=(0,T.getParams)("loginParams"),g=h&&h.phone?h.phone:c.qsParams.loginParamsEncode?JSON.parse(S.decode(c.qsParams.loginParamsEncode)).phone:null,y=h&&h.idcard?h.idcard:c.qsParams.loginParamsEncode?JSON.parse(S.decode(c.qsParams.loginParamsEncode)).idcard:null,k=h&&h.name?h.name:c.qsParams.loginParamsEncode?JSON.parse(S.decode(c.qsParams.loginParamsEncode)).name:null;(0,l.submitTaskHelper)({taskType:"sametrade",taskSubType:"",username:u.account,password:u.password,loginType:n.login_type,platformId:o,mobile:g,idCard:y,realName:k,creatTaskType:i?"preTask":null,preTaskId:i,captcha:m}).then(function(e){if(e.body.task_id){t.setState({isStart:!1}),f.default.refreshStatus("2","创建任务成功"),f.default.mxSaveTaskId(e.body.task_id);var a={taskId:e.body.task_id,platformId:o,username:u.account,loginModel:n.loginModel,loginType:n.login_type,taskType:"sametrade",loginParam:{account:u.account,idCard:u.idCard,realName:u.realName}};r(a)}}).catch(function(a){t.setState({isStart:!1}),console.log(a),f.default.refreshStatus("-3","服务异常，创建任务失败"),console.log("登录失败，标记失败"),e(),t.handleError(a)})},getLastLogin:function(){var e=this.props,t=e.pageConfig,a=e.platformId;return d.default.get("sametrade",a,t.loginModel,t.login_type)},handleError:function(e){try{defaultMessage=e&&e.body&&e.body.detail||defaultMessage}catch(t){f.default.alert("网络异常，请稍后再试!\n"+ +e,"")}this.setState({isStart:!1})},handleTanentProtocol:function(){var e=c.qsParams.tenantAgreementUrl&&"undefined"!=c.qsParams.tenantAgreementUrl?c.qsParams.tenantAgreementUrl:"";f.default.openWebView("用户使用协议",e,"","agreement")},handleProtocol:function(){var e=f.default.Device.SDK?0:c.qsParams.showTitleBar,t=c.qsParams.themeColor,a=c.qsParams.agreementUrl&&"undefined"!=c.qsParams.agreementUrl?c.qsParams.agreementUrl:"https://api.51datakey.com/h5/agreement.html?showTitleBar="+e+"&themeColor="+t;f.default.openWebView("用户使用协议",a,"","agreement")},selectLoginType:function(e){this.state.isStart||this.setState({loginTypeIndex:e})},doneLogin:function(e){return e.importResult={},this.props.setTaskStore(e),this.props.onLoginDone(),!0},autoImport:function(){this.props.auto&&this.handleImport()},tryGetCachedValue:function(e){var t=this.props.inMemoryLogin,a=this.getLastLogin(),n="";return a&&a.loginParam&&(n=(0,c.testPassword)(e)?a.loginFail?null:"":a.loginParam[e]),t&&t.loginParam&&t.loginParam[e]&&(n=t.loginParam[e]),n},wrapValidator:function(e){return function(t){return""===t||new RegExp(e).test(t)}}});t.default=I,e.exports=t.default}).call(this)}finally{}},819:function(e,t,a){try{(function(){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}function n(e,t){var a={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},s=function(){function e(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,a,n){return a&&e(t.prototype,a),n&&e(t,n),t}}(),l=function(e,t,a){for(var n=!0;n;){var o=e,r=t,i=a;n=!1,null===o&&(o=Function.prototype);var s=Object.getOwnPropertyDescriptor(o,r);if(void 0!==s){if("value"in s)return s.value;var l=s.get;if(void 0===l)return;return l.call(i)}var u=Object.getPrototypeOf(o);if(null===u)return;e=u,t=r,a=i,n=!0,s=u=void 0}},u=a(2),d=t(u),c=a(1),p=a(4),f=t(p),m=a(19),h=t(m),g=a(8),y=a(9),k=t(y),v=a(235),b=t(v),T=a(54),S=t(T),I=a(18),P=t(I),E=a(6),C=t(E),w=a(7),O=t(w),_=a(13),q=(t(_),a(5)),x=(t(q),a(15)),L=t(x),N=a(11),A=t(N),D=a(21),M=t(D),U=a(17),j=a(14),V=t(j),F=a(24),B=a(22),z=t(B),G=a(40),R="此次尝试失败，请重试",H="验证完成",W="fundImportTask",K=function(e){function t(e,a){o(this,t),l(Object.getPrototypeOf(t.prototype),"constructor",this).call(this,e,a),this.wrapView=this.wrapView.bind(this),this.renderImportPages=this.renderImportPages.bind(this),this.onIndexChange=this.onIndexChange.bind(this),this.state={pages:[],matchPages:[],currentPhone:Number(c.qsParams.mobile)?c.qsParams.mobile:"",taskStatus:U.TASK_STATUS.DEFAULT,isLoginDone:!1,showSpiner:!0,taskInfo:null,show:null,invalid:"YES"===c.qsParams.invalid||1==c.qsParams.invalid,isCheckingStatus:!0,selectedIndex:0,platformName:c.qsParams.platformName||"同业账单",preGetImgCode:!1,imgCode:null,preTaskId:null,requestImgCode:!0}}return r(t,e),s(t,[{key:"componentDidMount",value:function(){var e=this,t=String(this.props.params.platformId||c.qsParams.platformId);return t?((0,g.fetchLoginConfig)({taskType:"getSametradeSupportCapcha",platformId:t}).then(function(a){e.setState({preGetImgCode:a.body}),1==a.body&&(0,g.fetchLoginConfig)({taskType:"sametradeGetImgCode",platformId:t}).then(function(t){e.setState({requestImgCode:!1}),t.body&&t.body.image&&e.setState({imgCode:t.body.image,preTaskId:t.body.task_id})})}).catch(function(e){console.log(e)}),void(0,g.fetchLoginConfig)({taskType:"sametrade",platformId:t}).then(function(t){t.body.city,f.default.refreshTitle(e.state.platformName);var a=t.body,n=c.qsParams.loginOthersHide,o=!1,r={};(0,G.getParams)("loginParams")&&(o=!0,r=(0,G.getParams)("loginParams"));var i=a.filter(function(e){return!o||!(("YES"==n||1==n)&&void 0==r[e.login_type])});0==i.length?e.setState({pages:a,matchPages:i,invalid:!0,unsupportMessage:"抱歉，该登录方式暂不支持"}):e.setState({pages:a,matchPages:i})}).then(function(){e.setState({isCheckingStatus:!1})}).catch(function(t){console.log(t),e.setState({invalid:!0,isCheckingStatus:!1})})):void this.setState({invalid:!0})}},{key:"render",value:function(){var e=this,t=this.wrapView,a=(this.handleBack,this.state),o=a.pages,r=a.isCheckingStatus,i=a.invalid,s=(n(this.props,[]),""),l=t(s,d.default.createElement("div",{className:"centered"},d.default.createElement(A.default,{size:"44",color:"#999"})));return o&&o.length>0&&(l=this.state.isLoginDone?this.state.taskStatus==U.TASK_STATUS.DEFAULT?d.default.createElement(M.default,{desc:this.state.desc}):d.default.createElement(z.default,{succ:this.state.taskStatus==U.TASK_STATUS.SUCC,taskInfo:this.state.taskInfo,desc:this.state.desc}):d.default.createElement("div",null,this.renderImportPages(),this.state.taskInfo&&this.state.showSpiner?d.default.createElement(L.default,{color:"#fff",showTips:this.state.desc}):null)),i&&(l=t(s,d.default.createElement("div",{className:"service-unsupport"},d.default.createElement("i",null),d.default.createElement("p",null,"抱歉，该服务暂不可用")))),r&&(l=t(s,d.default.createElement("div",{className:"centered"},d.default.createElement(A.default,{size:"44",color:"#999"})))),d.default.createElement("div",{className:"import-onlinebank"},d.default.createElement("div",{className:"mx-view"},"NO"==c.qsParams.showTitleBar||0==c.qsParams.showTitleBar||f.default.Device.SDK?null:d.default.createElement("div",{style:{height:"NO"==c.qsParams.showTitleBar||f.default.Device.SDK?0:44}},d.default.createElement(C.default,{title:this.state.platformName,left:d.default.createElement(O.default,{onTap:function(){k.default.call(e)}},d.default.createElement("i",{className:"ion-chevron-left"}))})),l))}},{key:"getVcodeAgain",value:function(){var e=this;if(1==this.state.requestImgCode)return!1;this.setState({requestImgCode:!0});var t=String(this.props.params.platformId||c.qsParams.platformId);(0,g.fetchLoginConfig)({taskType:"sametradeGetImgCode",platformId:t}).then(function(t){t.body&&t.body.image&&e.setState({imgCode:t.body.image,preTaskId:t.body.task_id}),e.setState({requestImgCode:!1})})}},{key:"renderImportPages",value:function(){var e=this,t=this.onIndexChange,a=this.wrapView,o=(this.handleBack,this.state),r=o.selectedIndex,s=o.currentLogin,l=(o.pages,o.matchPages),u=o.preGetImgCode,p=o.preTaskId,f=o.imgCode,m=n(this.props,[]),h="",g=String(this.props.params.platformId||c.qsParams.platformId),y=d.default.createElement(S.default,{selectedIndex:r,onIndexChange:t},l.map(function(t){return t.loginModel=0,d.default.createElement("div",{title:t.label,key:t.login_type},d.default.createElement(b.default,i({key:t.login_type,preGetImgCode:u,imgCode:f,preTaskId:p,platformId:g,inMemoryLogin:s&&s.loginModel===t.loginModel?s:null,pageConfig:t,getVcodeAgain:e.getVcodeAgain.bind(e),onSubmitTaskDone:e.onSubmitTaskDone.bind(e)},m)))}));return a(h,y)}},{key:"wrapView",value:function(e,t){return d.default.createElement("div",null,e,d.default.createElement(P.default,null,t))}},{key:"onIndexChange",value:function(e){this.setState({selectedIndex:e})}},{key:"onSubmitTaskDone",value:function(e){this.props.hideVCodeModal(),window.storage.setItem(W,JSON.stringify(e)),this.setState({taskInfo:e}),this.startPoll()}},{key:"refreshImgCode",value:function(){var e=this;if(1==this.state.preGetImgCode){this.setState({requestImgCode:!0});var t=String(this.props.params.platformId||c.qsParams.platformId);(0,g.fetchLoginConfig)({taskType:"sametradeGetImgCode",platformId:t}).then(function(t){t.body&&t.body.image&&e.setState({imgCode:t.body.image,preTaskId:t.body.task_id}),e.setState({requestImgCode:!1})})}}},{key:"startPoll",value:function(){(0,h.default)({task:this.state.taskInfo,isLogin:!1,callbacks:{waitCode:this.initVCode.bind(this),doneLogin:this.doneLogin.bind(this),doneSucc:this.onSucc.bind(this),doneFail:this.onFail.bind(this),doneTimeout:this.onFail.bind(this),doing:this.updateState.bind(this),pendingTimeout:this.onPendingTimeout.bind(this),error:this.onError.bind(this),refreshImgCode:this.refreshImgCode.bind(this)
}})}},{key:"initVCode",value:function(e,t){var a=this;return this.setState({showSpiner:!1}),this.props.showVCodeModal({title:"验证码",desc:t.description,waitSeconds:0,type:t.input.type,imgSrc:"img"==t.input.type?t.input.value:"",onConfirm:function(t){a.submitVCode(t,e),a.setState({showSpiner:!0})},onCancel:function(){a.storeLoginInfo(e,!0),a.setState({taskInfo:null,showSpiner:!0})}}),this.updateState(e,t),!0}},{key:"submitVCode",value:function(e,t){var a=this;(0,g.submitVCode)(e,t).catch(function(e){console.log(e)}).then(function(){return a.startPoll()})}},{key:"doneLogin",value:function(e,t){this.updateState(e,t),this.setState({isLoginDone:!0})}},{key:"removeTaskStore",value:function(){window.storage.removeItem(W)}},{key:"updateState",value:function(e,t){return this.setState({phase:t.phase,desc:t.description,isLoginDone:t.phase!==F.PHASE.LOGIN}),!!this.state.hasQuit}},{key:"storeLoginInfo",value:function(e){var t=!(arguments.length<=1||void 0===arguments[1])&&arguments[1];this.removeTaskStore();var a=this.props.params.cardType||c.qsParams.cardType;void 0==e.bankId&&(e.bankId=0),void 0==e.loginModel&&(e.loginModel=0),void 0==e.loginType&&(e.loginType=0),V.default.set(e.taskType,e.bankId,a,e.loginType,{loginParam:e.loginParam,loginFail:t})}},{key:"onSucc",value:function(e,t){this.storeLoginInfo(e),t.description=H,this.updateState(e,t),this.setState({taskStatus:U.TASK_STATUS.SUCC})}},{key:"onFail",value:function(e,t){this.storeLoginInfo(e,!0),t.phase!=F.PHASE.LOGIN&&this.setState({taskStatus:U.TASK_STATUS.FAIL,desc:t.description}),this.setState({taskInfo:null})}},{key:"onPendingTimeout",value:function(e){this.storeLoginInfo(e),this.setState({taskStatus:U.TASK_STATUS.FAIL,desc:R,taskInfo:null})}},{key:"onError",value:function(e,t){console.log(t),this.storeLoginInfo(e,!0),this.setState({taskStatus:U.TASK_STATUS.FAIL,desc:"服务异常,请稍后再试",taskInfo:null})}},{key:"handleBack",value:function(){(this.state.isLoginDone||this.state.isFail)&&(c.qsParams.backUrl||c.qsParams.back_url)?quitBack({taskType:"sametrade"}):(this.setState({hasQuit:!0}),k.default.call(this))}}],[{key:"propTypes",value:{showVCodeModal:u.PropTypes.func,hideVCodeModal:u.PropTypes.func},enumerable:!0}]),t}(d.default.Component);e.exports=K}).call(this)}finally{}}});